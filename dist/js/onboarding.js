/*! (c) Philipp KÃ¶nig under GPL-3.0 */
"use strict";!function(e){window.onboarding=function(){var t=this;this.opts={elm:{body:e("body"),title:e("head > title"),sidebar:{left:e("div#sidebar")}},classes:{initLoading:"initLoading",slide:"slide",skip:"skip",close:"close",gotoSettings:"gotoSettings",large:"large",visible:"visible"},attr:{name:"data-name",value:"data-value",position:"data-position",openType:"data-openType",surface:"data-surface"},events:{sidebarOpened:"blockbyte-bs-sidebar-opened"},manifest:chrome.runtime.getManifest()},this.run=function(){u();var r=t.helper.template.loading().appendTo(t.opts.elm.body);t.helper.model.init(function(){t.helper.i18n.init(function(){t.helper.font.init(),t.helper.stylesheet.init(),t.helper.stylesheet.addStylesheets(["onboarding"],e(document)),t.helper.i18n.parseHtml(document),t.opts.elm.title.text(t.opts.elm.title.text()+" - "+t.helper.i18n.get("extension_name")),t.opts.elm.sidebar.right=e(t.opts.elm.sidebar.left[0].outerHTML).appendTo(t.opts.elm.body),t.opts.elm.sidebar.right.attr(t.opts.attr.position,"right"),s(),o(),n(),i(),a(),l(),setTimeout(function(){t.opts.elm.body.removeClass(t.opts.classes.initLoading),c("intro"),setTimeout(function(){r.remove()},300)},500)})})};var s=function(){e("section."+t.opts.classes.slide+"["+t.opts.attr.name+"='intro'] > a").on("click",function(s){s.preventDefault(),e(s.currentTarget).hasClass(t.opts.classes.skip)?p(!0):r()})},o=function(){e("section."+t.opts.classes.slide+"["+t.opts.attr.name+"='position'] > a").on("mouseenter click",function(s){s.preventDefault();var o=e(s.currentTarget).attr(t.opts.attr.value);t.opts.elm.body.attr(t.opts.attr.position,o),Object.values(t.opts.elm.sidebar).forEach(function(e){e.removeClass(t.opts.classes.visible)}),t.opts.elm.sidebar[o].addClass(t.opts.classes.visible),"click"===s.type&&t.helper.model.setData({"a/sidebarPosition":o},function(){r()})}).on("mouseleave",function(s){var o=e(s.currentTarget).parent();setTimeout(function(){o.hasClass(t.opts.classes.visible)&&Object.values(t.opts.elm.sidebar).forEach(function(e){e.removeClass(t.opts.classes.visible)})},0)})},n=function(){e("section."+t.opts.classes.slide+"["+t.opts.attr.name+"='surface'] > a").on("mouseenter click",function(s){s.preventDefault();var o=e(s.currentTarget).attr(t.opts.attr.value);if(t.opts.elm.body.attr(t.opts.attr.surface,o),"click"===s.type){var n=t.helper.model.getData("a/styles");n.colorScheme=t.helper.model.getDefaultColor("colorScheme",o),n.textColor=t.helper.model.getDefaultColor("textColor",o),n.bookmarksDirColor=t.helper.model.getDefaultColor("textColor",o),n.sidebarMaskColor=t.helper.model.getDefaultColor("sidebarMaskColor",o),t.helper.model.setData({"a/darkMode":"dark"===o,"a/styles":n},function(){r()})}}).on("mouseleave",function(s){var o=e(s.currentTarget).parent();setTimeout(function(){o.hasClass(t.opts.classes.visible)&&t.opts.elm.body.removeAttr(t.opts.attr.surface)},0)})},i=function(){e("section."+t.opts.classes.slide+"["+t.opts.attr.name+"='openAction'] > a").on("click",function(s){s.preventDefault();var o=e(s.currentTarget).attr(t.opts.attr.value);t.helper.model.setData({"b/openAction":o},function(){p()})})},a=function(){e(document).on(t.opts.events.sidebarOpened,function(){e("section."+t.opts.classes.slide+"["+t.opts.attr.name+"='finished']").hasClass(t.opts.classes.visible)||c("finished")})},l=function(){e("section."+t.opts.classes.slide+"["+t.opts.attr.name+"='finished'] > a").on("click",function(s){s.preventDefault(),e(s.currentTarget).hasClass(t.opts.classes.gotoSettings)?location.href=chrome.extension.getURL("html/settings.html"):e(s.currentTarget).hasClass(t.opts.classes.close)&&window.close()})},r=function(){var s=e("section."+t.opts.classes.slide+"."+t.opts.classes.visible).next("section."+t.opts.classes.slide).attr(t.opts.attr.name);c(s)},c=function(s){e("section."+t.opts.classes.slide+"."+t.opts.classes.visible).removeClass(t.opts.classes.visible),setTimeout(function(){e("section."+t.opts.classes.slide+"["+t.opts.attr.name+"='"+s+"']").addClass(t.opts.classes.visible)},300)},p=function(){var s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c("handson"),d(),Object.values(t.opts.elm.sidebar).forEach(function(e){e.removeClass(t.opts.classes.visible)});var o=e("section."+t.opts.classes.slide+"["+t.opts.attr.name+"='handson']");s&&o.children("p."+t.opts.classes.large).text(t.helper.i18n.get("onboarding_handson_desc_direct"));var n=t.helper.model.getData(["b/openAction","a/sidebarPosition"]);if(t.opts.elm.body.attr(t.opts.attr.position,n.sidebarPosition),"icon"===n.openAction)e("<p />").text(t.helper.i18n.get("onboarding_handson_icon_desc")).appendTo(o);else{var i=t.helper.i18n.get("onboarding_"+n.sidebarPosition);if(e("<p />").text(t.helper.i18n.get("onboarding_handson_mouse_desc_1",[i])).appendTo(o),"mousemove"!==n.openAction){var a=t.helper.i18n.get("onboarding_"+("contextmenu"===n.openAction?"right":"left"));e("<p />").text(t.helper.i18n.get("onboarding_handson_mouse_desc_2",[a])).appendTo(o)}}setTimeout(function(){t.opts.elm.body.attr(t.opts.attr.openType,"icon"===n.openAction?"icon":"mouse")},300)},d=function(){t.opts.manifest.content_scripts[0].css.forEach(function(t){e("head").append("<link href='"+chrome.extension.getURL(t)+"' type='text/css' rel='stylesheet' />")});!function e(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=t.opts.manifest.content_scripts[0].js[s];if(void 0!==o){var n=document.createElement("script");document.head.appendChild(n),n.onload=function(){return e(s+1)},n.src="/"+o}}()},u=function(){t.helper={i18n:new window.I18nHelper(t),font:new window.FontHelper(t),stylesheet:new window.StylesheetHelper(t),template:new window.TemplateHelper(t),model:new window.ModelHelper(t)}}},(new window.onboarding).run()}(jsu);