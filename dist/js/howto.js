/*! (c) Philipp KÃ¶nig under GPL-3.0 */
"use strict";!function(a){window.howto=function(){var b=this,c="mousedown",d="left";this.opts={elm:{title:a("head > title"),thanks:a("section#thanks"),tutorial:a("section#tutorial"),copyright:a("a#copyright"),close:a("a.close"),startTutorial:a("a.startTutorial")},classes:{visible:"visible",reversed:"reversed"},attr:{i18nReplaces:"data-i18nReplaces"},manifest:chrome.runtime.getManifest()},this.run=function(){e(),b.helper.i18n.init(function(){chrome.storage.sync.get(["behaviour","appearance"],function(a){a.behaviour&&a.behaviour.openAction&&(c=a.behaviour.openAction),a.appearance&&a.appearance.sidebarPosition&&(d=a.appearance.sidebarPosition),b.opts.elm.tutorial.children("p.text[data-index='1']").attr(b.opts.attr.i18nReplaces,b.helper.i18n.get("howto_tutorial_"+d)),b.opts.elm.tutorial.children("p.text[data-index='2']").attr(b.opts.attr.i18nReplaces,b.helper.i18n.get("howto_tutorial_"+("contextmenu"===c?"right":"left"))),b.helper.i18n.parseHtml(document),b.opts.elm.title.text(b.opts.elm.title.text()+" - "+b.opts.manifest.short_name),g(),f()})})};var e=function(){b.helper={i18n:new window.I18nHelper(b)}},f=function(){-1===location.href.search(/(\?|\&)tutorial\=1/)?b.opts.elm.thanks.addClass(b.opts.classes.visible):h()},g=function(){b.opts.elm.close.on("click",function(a){a.preventDefault(),window.close()}),b.opts.elm.startTutorial.on("click",function(a){if(a.preventDefault(),b.opts.elm.tutorial.hasClass(b.opts.classes.visible)){var c=location.href.replace(/(\?|\&)tutorial\=1/,"");location.href=c+(-1===c.search(/\?/)?"?":"&")+"tutorial=1"}else b.opts.elm.thanks.removeClass(b.opts.classes.visible),h()})},h=function(){b.opts.elm.tutorial.addClass(b.opts.classes.visible),b.opts.elm.tutorial.attr("data-pos",d);var a=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;setTimeout(function(){b.opts.elm.tutorial.children("p.text[data-index='2']").removeClass(b.opts.classes.visible),b.opts.elm.tutorial.children("div#sidebar").addClass(b.opts.classes.visible),b.opts.elm.tutorial.children("div#cursor").attr("data-step",3),setTimeout(function(){b.opts.elm.tutorial.children("p.text[data-index='3']").addClass(b.opts.classes.visible),setTimeout(function(){b.opts.elm.tutorial.children("div#cursor, p.text").removeClass(b.opts.classes.visible),b.opts.elm.tutorial.children("div#mask").addClass(b.opts.classes.visible)},3e3)},1e3)},a)},e=function(){"contextmenu"===c&&b.opts.elm.tutorial.children("div#cursor").addClass(b.opts.classes.reversed),setTimeout(function(){b.opts.elm.tutorial.children("p.text[data-index='2']").addClass(b.opts.classes.visible),b.opts.elm.tutorial.children("div#cursor").attr("data-step",2),a()},500)};setTimeout(function(){b.opts.elm.tutorial.children("p.text[data-index='1']").addClass(b.opts.classes.visible),setTimeout(function(){b.opts.elm.tutorial.children("div#cursor").addClass(b.opts.classes.visible),setTimeout(function(){b.opts.elm.tutorial.children("div#cursor").attr("data-step",1),setTimeout(function(){b.opts.elm.tutorial.children("p.text[data-index='1']").removeClass(b.opts.classes.visible),"mousemove"===c?a(700):e()},1500)},500)},1e3)},500)}},(new window.howto).run()}(jsu);