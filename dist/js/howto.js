/*! (c) Philipp KÃ¶nig under GPL-3.0 */
"use strict";!function(t){window.howto=function(){var e=this;this.opts={elm:{body:t("body"),title:t("head > title"),thanks:t("section#thanks"),tutorial:t("section#tutorial"),copyright:t("a#copyright"),close:t("a.close"),startTutorial:t("a.startTutorial")},classes:{visible:"visible",reversed:"reversed",initLoading:"initLoading"},attr:{i18nReplaces:"data-i18nReplaces"},manifest:chrome.runtime.getManifest()},this.run=function(){s(),e.helper.model.init(function(){e.helper.i18n.init(function(){e.helper.font.init(),e.helper.stylesheet.init(),e.helper.stylesheet.addStylesheets(["howto"],t(document));var s=e.helper.model.getData(["b/openAction","a/sidebarPosition"]);e.opts.elm.tutorial.children("p.text[data-index='1']").attr(e.opts.attr.i18nReplaces,e.helper.i18n.get("howto_tutorial_"+s.sidebarPosition)),e.opts.elm.tutorial.children("p.text[data-index='2']").attr(e.opts.attr.i18nReplaces,e.helper.i18n.get("howto_tutorial_"+("contextmenu"===s.openAction?"right":"left"))),e.helper.i18n.parseHtml(document),e.opts.elm.title.text(e.opts.elm.title.text()+" - "+e.helper.i18n.get("extension_name")),o(),i(),setTimeout(function(){e.opts.elm.body.removeClass(e.opts.classes.initLoading)},100)})})};var s=function(){e.helper={i18n:new window.I18nHelper(e),font:new window.FontHelper(e),stylesheet:new window.StylesheetHelper(e),model:new window.ModelHelper(e)}},i=function(){-1===location.href.search(/(\?|\&)tutorial\=1/)?e.opts.elm.thanks.addClass(e.opts.classes.visible):l()},o=function(){e.opts.elm.close.on("click",function(t){t.preventDefault(),window.close()}),e.opts.elm.startTutorial.on("click",function(t){if(t.preventDefault(),e.opts.elm.tutorial.hasClass(e.opts.classes.visible)){var s=location.href.replace(/(\?|\&)tutorial\=1/,"");location.href=s+(-1===s.search(/\?/)?"?":"&")+"tutorial=1"}else e.opts.elm.thanks.removeClass(e.opts.classes.visible),l()})},l=function(){var t=e.helper.model.getData(["b/openAction","a/sidebarPosition"]);e.opts.elm.tutorial.addClass(e.opts.classes.visible),e.opts.elm.tutorial.attr("data-pos",t.sidebarPosition);var s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;setTimeout(function(){e.opts.elm.tutorial.children("p.text[data-index='2']").removeClass(e.opts.classes.visible),e.opts.elm.tutorial.children("div#sidebar").addClass(e.opts.classes.visible),e.opts.elm.tutorial.children("div#cursor").attr("data-step",3),setTimeout(function(){e.opts.elm.tutorial.children("p.text[data-index='3']").addClass(e.opts.classes.visible),setTimeout(function(){e.opts.elm.tutorial.children("div#cursor, p.text").removeClass(e.opts.classes.visible),e.opts.elm.tutorial.children("div#mask").addClass(e.opts.classes.visible)},3e3)},1e3)},t)},i=function(){"contextmenu"===t.openAction&&e.opts.elm.tutorial.children("div#cursor").addClass(e.opts.classes.reversed),setTimeout(function(){e.opts.elm.tutorial.children("p.text[data-index='2']").addClass(e.opts.classes.visible),e.opts.elm.tutorial.children("div#cursor").attr("data-step",2),s()},500)};setTimeout(function(){e.opts.elm.tutorial.children("p.text[data-index='1']").addClass(e.opts.classes.visible),setTimeout(function(){e.opts.elm.tutorial.children("div#cursor").addClass(e.opts.classes.visible),setTimeout(function(){e.opts.elm.tutorial.children("div#cursor").attr("data-step",1),setTimeout(function(){e.opts.elm.tutorial.children("p.text[data-index='1']").removeClass(e.opts.classes.visible),"mousemove"===t.openAction?s(700):i()},1500)},500)},1e3)},500)}},(new window.howto).run()}(jsu);