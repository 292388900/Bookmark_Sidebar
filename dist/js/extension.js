/*! (c) Philipp KÃ¶nig under GPL-3.0 */
"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}();!function(){var e="isDefined",t="forEach",a=function(s){var r=document,o=new WeakMap,n=new WeakMap,l=Symbol(),i="_fillNodeList";return function(){function d(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_classCallCheck(this,d);var a=e;if("string"==typeof e&&(!1===t||e.search("<")>-1)){var s=r.createElement("div");s.innerHTML=e,a=s.childNodes}this[i](a)}return _createClass(d,[{key:i,value:function(o){var n=this;if(s[e](o))if(o instanceof a)this[l]=o.get();else if("string"==typeof o)this[l]=r.querySelectorAll(o);else if(o instanceof Node||o instanceof HTMLDocument||o instanceof Window)this[l]=[o];else if(o instanceof NodeList||o instanceof HTMLCollection)this[l]=o;else{if("object"!==(void 0===o?"undefined":_typeof(o)))throw new DOMException("invalid parameter for jsu");this[l]=[],s[e](o[t])||(o=[o]),o[t](function(e){var r=function(e){-1===n[l].indexOf(e)&&n[l].push(e)};e instanceof a?e[t](r):Array.isArray(e)||e instanceof NodeList||e instanceof HTMLCollection||/^\[object (HTMLCollection|NodeList|Object)\]$/.test(e.toString())?s[t](e,r):n[l].push(e)})}else this[l]=[];this[t](function(e,t){n[t]=e})}},{key:t,value:function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s[t](this[l],e,a),this}},{key:"css",value:function(a,r){var o=!0,n=s[e](a),i=s[e](r),d=[];return this[t](function(e){n&&i&&"string"==typeof a?e.style[a]=r:n&&("string"==typeof a?(d.push(window.getComputedStyle(e)[a]),o=!1):"object"===(void 0===a?"undefined":_typeof(a))&&Object.keys(a)[t](function(t){"string"==typeof t&&(e.style[t]=a[t])}))}),o?this:this[l].length>1?d:d[0]}},{key:"attr",value:function(a,r){var o=!0,n=s[e](a),i=s[e](r),d=[];return this[t](function(l){var c=function(t,a){s[e](l[t])?l[t]=a:l.setAttribute(t,a)};n&&i&&"string"==typeof a?c(a,r):n&&("string"==typeof a?(d.push(function(t){return s[e](l[t])?l[t]:l.getAttribute(t)}(a)),o=!1):"object"===(void 0===a?"undefined":_typeof(a))&&Object.keys(a)[t](function(e){"string"==typeof e&&c(e,a[e])}))}),o?this:this[l].length>1?d:d[0]}},{key:"removeAttr",value:function(e){return this[t](function(t){t.removeAttribute(e)}),this}},{key:"clone",value:function(){return a._cloneElement(this)}},{key:"data",value:function(r,o){var i=!0,d=s[e](r),c=s[e](o),p=[];return this[t](function(l){var u=n.get(l),h=s[e](u);d&&c?a._addData(l,r,o):d?"string"==typeof r?(p.push(h?u[r]:void 0),i=!1):"object"===(void 0===r?"undefined":_typeof(r))&&Object.keys(r)[t](function(e){"string"==typeof e&&a._addData(l,e,r[e])}):(p.push(h?u:{}),i=!1)}),i?this:this[l].length>1?p:p[0]}},{key:"removeData",value:function(a){var r=!s[e](a);return this[t](function(t){var o=n.get(t);s[e](o)&&(r?n.delete(t):s[e](o[a])&&delete o[a])}),this}},{key:"on",value:function(e,r,o,n,l){var i=function(e,a){Object.keys(a)[t](function(t){try{Object.defineProperty(e,t,{value:a[t]})}catch(e){}})},d=o;"function"==typeof o?d=n:l=n,void 0===d&&(d=null),void 0===l&&(l=null);var c="string"==typeof r;return this[t](function(n){e.split(/\s+/g)[t](function(e){var p=function(a){i(a,{type:e}),c?s[t](n.querySelectorAll(":scope "+r),function(t){for(var s=a.target;s&&s!==n;){if(s===t){var r=new MouseEvent(e,a);i(r,{preventDefault:function(){a.preventDefault()},stopPropagation:function(){a.stopPropagation()},target:a.target,currentTarget:s}),o(r)}s=s.parentNode}}):"function"==typeof r&&r(a)};a._addEventListener(n,{event:e,fn:p,opts:d,wantsUntrusted:l})})},!0),this}},{key:"off",value:function(a){return this[t](function(r){var n=o.get(r);s[e](n)&&a.split(/\s+/g)[t](function(e){n[e]&&s[t](n[e],function(t,a){r.removeEventListener(e,t.fn),n[e].splice(a,1)},!0)})}),this}},{key:"trigger",value:function(e,a){var s=this;return e.split(/\s+/g)[t](function(e){var r=new Event(e,a);s[t](function(e){e.dispatchEvent(r)})}),this}},{key:"addClass",value:function(e){return this[t](function(t){t.classList.add(e)}),this}},{key:"removeClass",value:function(e){return this[t](function(t){t.classList.remove(e)}),this}},{key:"toggleClass",value:function(e){return this[t](function(t){t.classList.toggle(e)}),this}},{key:"hasClass",value:function(e){var a=[];return this[t](function(t){a.push(t.classList.contains(e))}),this[l].length>1?a:a[0]}},{key:"_realDimension",value:function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=[],r="width",o=["left","right"];return"h"===e&&(r="height",o=["top","bottom"]),this[t](function(e){var t=e.getBoundingClientRect(),n=window.getComputedStyle(e),l=t[r];a&&(l+=parseInt(n.getPropertyValue("margin-"+o[0])),l+=parseInt(n.getPropertyValue("margin-"+o[1]))),s.push(l)}),this[l].length>1?s:s[0]}},{key:"realWidth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._realDimension("w",e)}},{key:"realHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._realDimension("h",e)}},{key:"find",value:function(e){var s=[];return this[t](function(t){t instanceof HTMLIFrameElement?s.push(t.contentDocument.querySelectorAll(":scope "+e)):s.push(t.querySelectorAll(":scope "+e))}),new a(s)}},{key:"children",value:function(e){var s=[];return e||(e="*"),this[t](function(t){s.push(t.querySelectorAll(":scope > "+e))}),new a(s)}},{key:"_htmlText",value:function(a,r){var o=s[e](a),n=o?this:"";return this[t](function(e){o?e[r]=a:n+=e[r]}),n}},{key:"html",value:function(e){return this._htmlText(e,"innerHTML")}},{key:"text",value:function(e){return this._htmlText(e,"innerText")}},{key:"remove",value:function(){this[t](function(e){e&&e.parentElement&&(o.delete(e),n.delete(e),e.parentElement.removeChild(e))})}},{key:"_moveElement",value:function(e){var s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments[2];"string"==typeof e&&e.search("<")>-1&&(s=!1);var o=new a(e,s);return this[t](function(e){a._cloneElement(o)[t](function(t){switch(r){case"append":e.appendChild(t);break;case"prepend":e.insertBefore(t,e.firstChild);break;case"before":e.parentNode.insertBefore(t,e);break;case"after":e.parentNode.insertBefore(t,e.nextSibling)}})}),o.remove(),this}},{key:"_moveElementTo",value:function(e,s){var r=this,o=[];return new a(e)[t](function(e){a._cloneElement(r)[t](function(t){switch(s){case"append":e.appendChild(t);break;case"prepend":e.insertBefore(t,e.firstChild);break;case"before":e.parentNode.insertBefore(t,e);break;case"after":e.parentNode.insertBefore(t,e.nextSibling)}o.push(t)})}),this.remove(),new a(o)}},{key:"append",value:function(e,t){return this._moveElement(e,t,"append")}},{key:"appendTo",value:function(e){return this._moveElementTo(e,"append")}},{key:"prepend",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._moveElement(e,t,"prepend")}},{key:"prependTo",value:function(e){return this._moveElementTo(e,"prepend")}},{key:"before",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._moveElement(e,t,"before")}},{key:"insertBefore",value:function(e){return this._moveElementTo(e,"before")}},{key:"after",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._moveElement(e,t,"after")}},{key:"insertAfter",value:function(e){return this._moveElementTo(e,"after")}},{key:"_nextPrev",value:function(r,o){var n=s[e](r),l=[];return this[t](function(t){var a="prev"===o?t.previousElementSibling:t.nextElementSibling;s[e](a)&&(!n||s[e](a.matches)&&a.matches(r))&&l.push(a)}),new a(l)}},{key:"next",value:function(e){return this._nextPrev(e,"next")}},{key:"prev",value:function(e){return this._nextPrev(e,"prev")}},{key:"_siblings",value:function(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"siblings",n=s[e](r),i=[];return this[t](function(e){var t=null,s=[];for("siblings"===o&&e.parentNode.firstElementChild?(t=e.parentNode.firstElementChild,o="next"):"previous"!==o&&"next"!==o||(t=e[o+"ElementSibling"]);t&&t.matches;)t===e||n&&!t.matches(r)||s.push(t),t=t[o+"ElementSibling"];i.push(new a(s))}),this[l].length>1?i:i[0]}},{key:"siblings",value:function(e){return this._siblings(e)}},{key:"nextAll",value:function(e){return this._siblings(e,"next")}},{key:"prevAll",value:function(e){return this._siblings(e,"previous")}},{key:"parent",value:function(r){var o=s[e](r),n=[];return this[t](function(t){var l=t.parentNode;!o||s[e](l.matches)&&l.matches(r)||(l=null),n.push(new a(l))}),this[l].length>1?n:n[0]}},{key:"parents",value:function(r){var o=this,n=s[e](r),i=[];return this[t](function(e){for(var t=[],s=e.parentNode;s&&s.matches&&s!==o;)n&&!s.matches(r)||t.push(s),s=s.parentNode;i.push(new a(t))}),this[l].length>1?i:i[0]}},{key:"document",value:function(){var e=[];return this[t](function(t){e.push(new a(t.ownerDocument))}),this[l].length>1?e:e[0]}},{key:"eq",value:function(e){return e<0&&(e=this[l].length+e),new a(this[l][e])}},{key:"get",value:function(t){return s[e](t)?(t<0&&(t=this[l].length+t),this[l][t]):this[l]}},{key:"length",value:function(){return this[l].length}}],[{key:"_addEventListener",value:function(t,a){var r=o.get(t);s[e](r)||(r={},o.set(t,r)),r[a.event]||(r[a.event]=[]),r[a.event].push({fn:a.fn,opts:a.opts,wantsUntrusted:a.wantsUntrusted}),t.addEventListener(a.event,a.fn,a.opts,a.wantsUntrusted)}},{key:"_cloneEventListener",value:function(r,n){var l=o.get(r);s[e](l)&&Object.keys(l)[t](function(e){l[e][t](function(t){a._addEventListener(n,{event:e,fn:t.fn,opts:t.opts,wantsUntrusted:t.wantsUntrusted})})}),n.children&&s[t](n.children,function(e,t){a._cloneEventListener(r.children[t],e)})}},{key:"_addData",value:function(t,a,r){var o=n.get(t);s[e](o)||(o={},n.set(t,o)),o[a]=r}},{key:"_cloneData",value:function(r,o){var l=n.get(r);s[e](l)&&Object.keys(l)[t](function(e){a._addData(o,e,l[e])}),o.children&&s[t](o.children,function(e,t){a._cloneData(r.children[t],e)})}},{key:"_cloneElement",value:function(e){var s=[];return e[t](function(e){var t=e.cloneNode(!0);a._cloneEventListener(e,t),a._cloneData(e,t),s.push(t)}),new a(s)}}]),d}()}(function(){return function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:e,value:function(e){return void 0!==e&&null!==e}},{key:t,value:function(a,s){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=a.length;if(r){for(var n=o-1;n>=0;n--)if(this[e](a[n][t]))this[t](a[n],s,r);else if(!1===s(a[n],n))break}else for(var l=0;l<o;l++)if(this[e](a[l][t]))this[t](a[l],s,r);else if(!1===s(a[l],l))break}}]),a}()}());window.jsu=function(e){return new a(e)}}(),function(e){window.CheckboxHelper=function(t){var a=this,s={};this.get=function(s,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"checkbox",l=e("<div />").html("<input type='checkbox' />").data("uid",Math.random().toString(36).substr(2,12)).attr(t.opts.attr.type,o).addClass(t.opts.classes.checkbox.box);return void 0!==r&&(l.children("input[type='checkbox']").attr(r),r[t.opts.attr.name]&&l.attr(t.opts.attr.name,r[t.opts.attr.name])),a.isChecked(l)&&l.addClass(t.opts.classes.checkbox.active),n(l,s),l},this.isChecked=function(e){return e.find("input[type='checkbox']")[0].checked};var r=function(e,a){var s=e.children("input[type='checkbox']");s.trigger("change"),a.document()[0].dispatchEvent(new CustomEvent(t.opts.events.checkboxChanged,{detail:{container:e,checkbox:s,checked:e.hasClass(t.opts.classes.checkbox.active)},bubbles:!0,cancelable:!1}))},o=function o(n,l){n.addClass(t.opts.classes.checkbox.clicked),n.removeClass(t.opts.classes.checkbox.focus),n.toggleClass(t.opts.classes.checkbox.active);var i=n.hasClass(t.opts.classes.checkbox.active),d=n.children("input[type='checkbox']");if("radio"===n.attr(t.opts.attr.type)&&n.attr(t.opts.attr.name))if(l){var c=n.attr(t.opts.attr.name);n.addClass(t.opts.classes.checkbox.active),i&&(d.attr("checked",!0),r(n,l)),l.find("div."+t.opts.classes.checkbox.box+"["+t.opts.attr.type+"='radio']["+t.opts.attr.name+"='"+c+"']").forEach(function(t){var s=e(t);t!==n[0]&&a.isChecked(s)&&o(s)})}else d.attr("checked",!1);else d.attr("checked",i),r(n,l);var p=n.data("uid");s[p]&&clearTimeout(s[p]),s[p]=setTimeout(function(){n.removeClass(t.opts.classes.checkbox.clicked)},300)},n=function(a,s){a.on("mousedown",function(a){a.preventDefault(),a.stopPropagation(),e(a.currentTarget).addClass(t.opts.classes.checkbox.focus)}).on("click",function(t){t.preventDefault(),t.stopPropagation(),o(e(t.currentTarget),s)}),s.on("click",function(){a.removeClass(t.opts.classes.checkbox.focus)})}},window.ContextmenuHelper=function(t){var a=this;this.create=function(i,c){if(!1===s(i,c)){a.close(),c.addClass(t.opts.classes.sidebar.active);var p=e("<div />").addClass(t.opts.classes.contextmenu.wrapper).html("<ul class='"+t.opts.classes.contextmenu.list+"'></ul><ul class='"+t.opts.classes.contextmenu.icons+"'></ul>").attr(t.opts.attr.type,i).data("elm",c).appendTo(t.elements.sidebar),u=i,h=c.attr(t.opts.attr.id);switch(h&&p.attr(t.opts.attr.id,h),i){case"list":l(p,c),u=t.helper.entry.getData(h).isDir?"directory":"bookmark";break;case"separator":n(p,c);break;case"menu":o(p,c);break;case"sort":r(p,c)}t.helper.model.call("trackEvent",{category:"contextmenu",action:"open",label:u}),d(p),setTimeout(function(){p.addClass(t.opts.classes.contextmenu.visible);var e=parseInt(p.css("top")),a=p.realHeight();e+a>=window.innerHeight&&p.css("top",e-a).addClass(t.opts.classes.contextmenu.top)},0)}};var s=function(e,a){var s=a.attr(t.opts.attr.id),r="div."+t.opts.classes.contextmenu.wrapper+"["+t.opts.attr.type+"='"+e+"']";return s&&(r+="["+t.opts.attr.id+"='"+s+"']"),t.elements.sidebar.find(r).length()>0};this.close=function(){var a=t.elements.iframeBody.find("div."+t.opts.classes.contextmenu.wrapper);a.forEach(function(a){e(a).removeClass(t.opts.classes.contextmenu.visible),e(a).data("elm").removeClass(t.opts.classes.sidebar.active)}),setTimeout(function(){a.remove()},500)};var r=function(a,s){var r=t.helper.list.getSortList(),o=t.helper.list.getSort(),n=a.children("ul."+t.opts.classes.contextmenu.list);a.children("ul."+t.opts.classes.contextmenu.icons).remove(),Object.keys(r).forEach(function(s){var r,l=s.replace(/([A-Z])/g,"_$1").toLowerCase();e("<li />").append(t.helper.checkbox.get(t.elements.iframeBody,(r={},_defineProperty(r,t.opts.attr.name,"sort"),_defineProperty(r,t.opts.attr.value,s),r),"radio")).append("<a "+t.opts.attr.name+"='sort'>"+t.helper.i18n.get("sort_label_"+l)+"</a>").appendTo(n),s===o.name&&a.find("input["+t.opts.attr.name+"='sort']["+t.opts.attr.value+"='"+s+"']").parent("div."+t.opts.classes.checkbox.box).trigger("click")});var l=s[0].getBoundingClientRect();a.css("top",l.top+l.height+"px")},o=function(a,s){var r=a.children("ul."+t.opts.classes.contextmenu.list),o=a.children("ul."+t.opts.classes.contextmenu.icons);"custom"===t.helper.list.getSort().name&&(e("<li />").append(t.helper.checkbox.get(t.elements.iframeBody,_defineProperty({},t.opts.attr.name,"toggleFix"))).append("<a "+t.opts.attr.name+"='toggleFix'>"+t.helper.i18n.get("contextmenu_toggle_fix")+"</a>").appendTo(r),!1===t.elements.sidebar.hasClass(t.opts.classes.sidebar.entriesUnlocked)&&a.find("input["+t.opts.attr.name+"='toggleFix']").parent("div."+t.opts.classes.checkbox.box).trigger("click")),e("<li />").append(t.helper.checkbox.get(t.elements.iframeBody,_defineProperty({},t.opts.attr.name,"toggleHidden"))).append("<a "+t.opts.attr.name+"='toggleHidden'>"+t.helper.i18n.get("contextmenu_toggle_hidden")+"</a>").appendTo(r),!0===t.elements.sidebar.hasClass(t.opts.classes.sidebar.showHidden)&&a.find("input["+t.opts.attr.name+"='toggleHidden']").parent("div."+t.opts.classes.checkbox.box).trigger("click"),o.append("<li><a "+t.opts.attr.name+"='settings' title='"+t.helper.i18n.get("contextmenu_settings")+"'></a></li>").append("<li><a "+t.opts.attr.name+"='bookmarkManager' title='"+t.helper.i18n.get("contextmenu_bookmark_manager")+"'></a></li>");var n=s[0].getBoundingClientRect();a.css("top",n.top+n.height+"px")},n=function(a,s){a.css({top:s[0].getBoundingClientRect().top+s.realHeight()+"px",left:s[0].offsetLeft+"px"});var r=e("<li />").appendTo(a.children("ul."+t.opts.classes.contextmenu.list));a.children("ul."+t.opts.classes.contextmenu.icons).remove(),console.log(s),e("<a />").attr(t.opts.attr.name,"deleteSeparator").text(t.helper.i18n.get("contextmenu_delete_separator")).data("infos",s.data("infos")).appendTo(r)},l=function(e,a){var s=a.attr(t.opts.attr.id),r=t.helper.entry.getData(s);e.css({top:a[0].getBoundingClientRect().top+a.realHeight()+"px",left:a[0].offsetLeft+"px"});var o=r.isDir?"_dir":"_bookmark",n=e.children("ul."+t.opts.classes.contextmenu.list),l=e.children("ul."+t.opts.classes.contextmenu.icons),i=t.elements.bookmarkBox.search.hasClass(t.opts.classes.sidebar.active);r.isDir?(r.children.filter(function(e){return!!e.url}).length>0&&n.append("<li><a "+t.opts.attr.name+"='openChildren'>"+t.helper.i18n.get("contextmenu_open_children")+"</a></li>"),r.children.length>0&&n.append("<li><a "+t.opts.attr.name+"='updateUrls'>"+t.helper.i18n.get("contextmenu_update_urls")+"</a></li>")):(i&&n.append("<li><a "+t.opts.attr.name+"='showInDir'>"+t.helper.i18n.get("contextmenu_show_in_dir")+"</a></li>"),n.append("<li><a "+t.opts.attr.name+"='newTab'>"+t.helper.i18n.get("contextmenu_new_tab")+"</a></li>"),!1===chrome.extension.inIncognitoContext&&n.append("<li><a "+t.opts.attr.name+"='newTabIncognito'>"+t.helper.i18n.get("contextmenu_new_tab_incognito")+"</a></li>")),l.append("<li><a "+t.opts.attr.name+"='infos' title='"+t.helper.i18n.get("contextmenu_infos")+"'></a></li>"),r.parents.length>0&&l.append("<li><a "+t.opts.attr.name+"='edit' title='"+t.helper.i18n.get("contextmenu_edit"+o)+"'></a></li>").append("<li><a "+t.opts.attr.name+"='delete' title='"+t.helper.i18n.get("contextmenu_delete"+o)+"'></a></li>"),r.isDir&&l.append("<li><a "+t.opts.attr.name+"='add' title='"+t.helper.i18n.get("contextmenu_add")+"'></a></li>"),t.helper.entry.isVisible(s)?l.append("<li class='"+t.opts.classes.contextmenu.right+"'><a "+t.opts.attr.name+"='hide' title='"+t.helper.i18n.get("contextmenu_hide_from_sidebar")+"'></a></li>"):!i&&a.parents("li."+t.opts.classes.sidebar.hidden).length()<=1&&l.append("<li class='"+t.opts.classes.contextmenu.right+"'><a "+t.opts.attr.name+"='show' title='"+t.helper.i18n.get("contextmenu_show_in_sidebar")+"'></a></li>")},i=function(s){s.find("input["+t.opts.attr.name+"='sort']").on("change",function(s){if(s.currentTarget.checked){var r=e(s.currentTarget).attr(t.opts.attr.value);t.helper.list.updateSort(r),a.close()}})},d=function(s){i(s),s.find("input["+t.opts.attr.name+"='toggleFix']").on("change",function(){t.elements.sidebar.toggleClass(t.opts.classes.sidebar.entriesUnlocked),t.helper.model.setData({"u/entriesLocked":!1===t.elements.sidebar.hasClass(t.opts.classes.sidebar.entriesUnlocked)}),a.close()}),s.find("input["+t.opts.attr.name+"='toggleHidden']").on("change",function(){t.startLoading(),t.elements.sidebar.toggleClass(t.opts.classes.sidebar.showHidden),t.helper.model.setData({"u/showHidden":!0===t.elements.sidebar.hasClass(t.opts.classes.sidebar.showHidden)},function(){t.helper.model.call("refreshAllTabs",{type:"ToggleHidden"})}),a.close()}),s.find("a").on("click",function(a){a.preventDefault();var r=e(a.currentTarget).attr(t.opts.attr.name),o=s.attr(t.opts.attr.id),n=o?t.helper.entry.getData(o):null;switch(r){case"settings":t.helper.model.call("openLink",{href:chrome.extension.getURL("html/settings.html"),newTab:!0});break;case"sort":case"toggleFix":case"toggleHidden":a.stopPropagation(),e(a.currentTarget).prev("div."+t.opts.classes.checkbox.box).trigger("click");break;case"bookmarkManager":t.helper.model.call("openLink",{href:"chrome://bookmarks",newTab:!0,active:!0});break;case"newTabIncognito":t.helper.model.call("trackEvent",{category:"url",action:"open",label:"new_window_incognito"}),t.helper.utility.openUrl(n,"incognito");break;case"newTab":t.helper.model.call("trackEvent",{category:"url",action:"open",label:"new_tab_contextmenu"}),t.helper.utility.openUrl(n,"newTab","foreground"===t.helper.model.getData("b/newTab"));break;case"deleteSeparator":t.helper.utility.removeSeparator(e(a.currentTarget).data("infos"),function(){t.helper.model.call("refreshAllTabs",{type:"Separator"})});break;case"show":t.startLoading();var l=t.helper.model.getData("u/hiddenEntries");delete l[o],t.helper.model.setData({"u/hiddenEntries":l},function(){t.helper.model.call("refreshAllTabs",{type:"Hide"})});break;case"openChildren":var i=n.children.filter(function(e){return!!e.url});i.length>10?t.helper.overlay.create(r,e(a.currentTarget).attr("title")||e(a.currentTarget).text(),n):(t.helper.model.call("trackEvent",{category:"url",action:"open",label:"new_tab_all_children",value:i.length}),i.forEach(function(e){t.helper.utility.openUrl(e,"newTab","foreground"===t.helper.model.getData("b/newTab"))}));break;case"showInDir":var d=t.helper.entry.getData(o);if(d&&d.parents){!function e(a){if(d.parents[a]){var s=t.elements.bookmarkBox.all.find("ul > li > a."+t.opts.classes.sidebar.bookmarkDir+"["+t.opts.attr.id+"='"+d.parents[a]+"']");s.hasClass(t.opts.classes.sidebar.dirOpened)?e(a+1):t.helper.list.toggleBookmarkDir(s,!0,function(){e(a+1)})}else{t.helper.search.clearSearch();var r=t.elements.bookmarkBox.all.find("ul > li > a["+t.opts.attr.id+"='"+o+"']");t.helper.scroll.setScrollPos(t.elements.bookmarkBox.all,r[0].offsetTop-50),r.addClass(t.opts.classes.sidebar.mark)}}(0)}break;default:t.helper.overlay.create(r,e(a.currentTarget).attr("title")||e(a.currentTarget).text(),n)}})}},window.DragDropHelper=function(t){var a=null,s=0,r=null,o={running:!1,posY:null,previousDelta:0,fpsLimit:30};this.init=function(){g(),l()};var n=function(e){var a=0;return a="object"===(void 0===e?"undefined":_typeof(e))?e[0].getBoundingClientRect().left:+e,"right"===t.elements.iframe.attr(t.opts.attr.position)&&(a=window.innerWidth-a),"object"===(void 0===e?"undefined":_typeof(e))?.6*e.realWidth()+a>t.elements.sidebar.realWidth():a>t.elements.sidebar.realWidth()},l=function(){t.elements.iframeBody.on("dragenter",function(){t.helper.contextmenu.close(),t.elements.iframeBody.addClass(t.opts.classes.drag.isDragged),t.elements.iframe.removeClass(t.opts.classes.page.isNewTab),d("selection"),o.running||window.requestAnimationFrame(u)}).on("drop dragend",function(a){if(a.preventDefault(),a.stopPropagation(),o.posY=null,t.elements.iframeBody.hasClass(t.opts.classes.drag.isDragged)){if(n(a.pageX))c("selection",!0);else{var s=t.elements.bookmarkBox.all.find("li."+t.opts.classes.drag.isDragged).eq(0);if(s&&s.length()>0){var r=a.dataTransfer.getData("URL"),l="";location.href===r&&(l=e(document).find("title").text()),c("selection"),t.helper.overlay.create("add",t.helper.i18n.get("contextmenu_add"),{values:{index:s.prevAll("li").length(),parentId:s.parent("ul").prev("a").attr(t.opts.attr.id),title:l,url:r}})}}t.elements.iframeBody.removeClass(t.opts.classes.drag.isDragged),"newtab"===t.helper.utility.getPageType()&&t.elements.iframe.addClass(t.opts.classes.page.isNewTab)}})},i=function(e){var a="bookmark";return"selection"===e?a=e:e.hasClass(t.opts.classes.sidebar.bookmarkDir)?a="directory":e.hasClass(t.opts.classes.sidebar.separator)&&(a="separator"),a},d=function(e){t.helper.model.call("trackEvent",{category:"dragndrop",action:i(e),label:"dragstart"})},c=function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.helper.model.call("trackEvent",{category:"dragndrop",action:i(e),label:a?"cancel":"dragend"})},p=function(a,s,r){t.helper.contextmenu.close();var n=e(a).parent("a").removeClass(t.opts.classes.sidebar.dirOpened),l=n.parent("li");i(n);t.elements.iframeBody.addClass(t.opts.classes.drag.isDragged),l.clone().addClass(t.opts.classes.drag.dragInitial).insertAfter(l);var c=n.clone().appendTo(t.elements.iframeBody),p=n[0].getBoundingClientRect(),h={};n.hasClass(t.opts.classes.sidebar.separator)||(h=t.helper.entry.getData(n.attr(t.opts.attr.id))),c.removeAttr("title").css({top:p.top+"px",left:p.left+"px",width:n.realWidth()+"px"}).data({elm:l,isDir:!!h.isDir,startPos:{top:r-p.top,left:s-p.left}}).addClass(t.opts.classes.drag.helper),l.addClass(t.opts.classes.drag.isDragged),d(n),o.running||window.requestAnimationFrame(u)},u=function e(a){window.requestAnimationFrame(e);var s=a-o.previousDelta;if(!(o.fpsLimit&&s<1e3/o.fpsLimit)){if(null!==o.posY){var r=t.elements.bookmarkBox.all[0].offsetTop,n=t.elements.bookmarkBox.all[0].offsetHeight,l=t.elements.bookmarkBox.all[0].scrollTop,i=null;o.posY-r<60?i=l-Math.pow((50-o.posY+r)/10,2):o.posY+60>n&&(i=l+Math.pow((o.posY+50-n)/10,2)),i&&t.helper.scroll.setScrollPos(t.elements.bookmarkBox.all,i)}o.previousDelta=a}},h=function(){m();var a=t.elements.iframeBody.children("a."+t.opts.classes.drag.helper),s=t.elements.bookmarkBox.all.find("li."+t.opts.classes.drag.dragInitial),r=a.data("elm"),o=r.children("a"),l=i(o);if(n(a))r.insertAfter(s).removeClass(t.opts.classes.drag.isDragged),s.remove(),a.remove(),c(o,!0);else{a.addClass(t.opts.classes.drag.snap);var d=r.parent("ul").prev("a").attr(t.opts.attr.id),p=0;r.prevAll("li").forEach(function(a){a===s||e(a).children("a").hasClass(t.opts.classes.sidebar.separator)||p++}),"separator"===l?t.helper.utility.removeSeparator(o.data("infos"),function(){var e={id:d,index:p};t.helper.utility.addSeparator(e),o.data("infos",e)}):t.helper.model.call("moveBookmark",{id:r.children("a").attr(t.opts.attr.id),parentId:d,index:p}),c(o),setTimeout(function(){var e=r[0].getBoundingClientRect();a.css({top:e.top+"px",left:e.left+"px"}),setTimeout(function(){r.removeClass(t.opts.classes.drag.isDragged),s.remove(),a.remove()},200)},0)}t.elements.iframeBody.removeClass(t.opts.classes.drag.isDragged),"newtab"===t.helper.utility.getPageType()&&setTimeout(function(){t.elements.iframe.addClass(t.opts.classes.page.isNewTab)},500)},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===r||null!==e&&r.id===e.attr(t.opts.attr.id)||(r.elm.removeClass(t.opts.classes.drag.dragHover),clearTimeout(r.instance),r=null)},f=function(l,i,d){o.posY=d;var c=null,p=null,u=0,h=0;if("dragover"===l){if(u=d-20,h=i,u===s)return!1;s=u,t.elements.bookmarkBox.all.find("li."+t.opts.classes.drag.isDragged).remove(),p=e("<li />").html("<a>&nbsp;</a>").addClass(t.opts.classes.drag.isDragged)}else{var f=(c=t.elements.iframeBody.children("a."+t.opts.classes.drag.helper)).data("startPos");u=d-f.top,h=i-f.left,c.css({top:u+"px",left:h+"px"}),p=c.data("elm")}if(n(c||h))return m(),t.elements.iframeBody.addClass(t.opts.classes.drag.cancel),!1;t.elements.iframeBody.removeClass(t.opts.classes.drag.cancel);var g=null;if(e([t.elements.bookmarkBox.all.find("> ul > li > a."+t.opts.classes.sidebar.dirOpened).parent("li"),t.elements.bookmarkBox.all.find("a."+t.opts.classes.sidebar.dirOpened+" + ul > li")]).forEach(function(a){var s=e(a);if(a!==p[0]&&!s.hasClass(t.opts.classes.drag.dragInitial)){if(a.getBoundingClientRect().top>u)return!1;g=s}}),g&&g!==a){a=g;var v=g.children("a").eq(0);if(m(v),v.hasClass(t.opts.classes.sidebar.bookmarkDir))if(v.hasClass(t.opts.classes.sidebar.dirOpened)){var b=p.prependTo(v.next("ul"));c&&c.data("elm",b)}else if(c&&c.data("isDir")){var k=p.insertAfter(g);c&&c.data("elm",k)}else v.hasClass(t.opts.classes.sidebar.dirAnimated)?0===v.next("ul").length()&&(v.addClass(t.opts.classes.sidebar.dirOpened),e("<ul />").insertAfter(v)):null===r&&((r={id:v.attr(t.opts.attr.id),elm:v.addClass(t.opts.classes.drag.dragHover)}).instance=setTimeout(function(){t.helper.list.toggleBookmarkDir(v)},700));else{var y=p.insertAfter(g);c&&c.data("elm",y)}}},g=function(){t.elements.bookmarkBox.all.children("ul").on("mousedown","span."+t.opts.classes.drag.trigger,function(e){var a=e.pageX,s="newtab"===t.helper.utility.getPageType();if(s&&"right"===t.elements.iframe.attr(t.opts.attr.position)){var r=t.elements.iframe.realWidth();t.elements.iframe.removeClass(t.opts.classes.page.isNewTab),a+=t.elements.iframe.realWidth()-r}else s&&t.elements.iframe.removeClass(t.opts.classes.page.isNewTab);p(e.currentTarget,a,e.pageY)}),t.elements.iframeBody.on("mouseup",function(e){o.posY=null,t.elements.iframeBody.hasClass(t.opts.classes.drag.isDragged)&&(e.preventDefault(),e.stopPropagation(),h())}),t.elements.iframeBody.on("wheel",function(e){if(t.elements.iframeBody.hasClass(t.opts.classes.drag.isDragged)){e.preventDefault(),e.stopPropagation();var a=t.elements.bookmarkBox.all[0].scrollTop;t.helper.scroll.setScrollPos(t.elements.bookmarkBox.all,a-e.wheelDelta,300)}}),t.elements.iframeBody.on("mousemove dragover",function(e){t.elements.iframeBody.hasClass(t.opts.classes.drag.isDragged)&&1===e.which&&(e.preventDefault(),e.stopPropagation(),f(e.type,e.pageX,e.pageY))}),t.elements.iframeBody.on("contextmenu","a."+t.opts.classes.drag.helper,function(e){e.preventDefault(),e.stopPropagation()})}},window.EntryHelper=function(e){var t={};this.update=function(a,s){e.helper.model.call("viewAmounts",function(r){var o=e.helper.model.getData("u/hiddenEntries"),n=e.elements.sidebar.hasClass(e.opts.classes.sidebar.showHidden);t={bookmarks:{},directories:{}};!function a(s){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s.forEach(function(s,d){if(n||!0!==o[s.id]){var c=[].concat(_toConsumableArray(l));"0"!==s.parentId&&c.push(s.parentId),s.hidden=i||!0===o[s.id],s.parents=c;var p=new Date(Math.max(s.dateAdded,r.counterStartDate)),u=Math.max(1,Math.round((+new Date-p)/2627999942.4));if(s.views={startDate:p,total:0},s.url){e.opts.demoMode&&(s.title=e.helper.i18n.get("overlay_label_bookmark")+" "+(d+1),s.url="https://example.com/");var h=0,m=r.viewAmounts[s.id]?r.viewAmounts[s.id].d||0:0;r.viewAmounts[s.id]?h=r.viewAmounts[s.id].c||+r.viewAmounts[s.id]:r.viewAmounts["node_"+s.id]&&(h=r.viewAmounts["node_"+s.id].c||+r.viewAmounts["node_"+s.id]),s.views.total=h,s.views.lastView=m,s.views.perMonth=Math.round(h/u*100)/100,c.forEach(function(e){t.directories[e].childrenAmount.bookmarks++,t.directories[e].views.total+=h,t.directories[e].views.lastView=Math.max(t.directories[e].views.lastView||0,m)}),t.bookmarks[s.id]=s}else s.children&&(e.opts.demoMode&&(s.title=e.helper.i18n.get("overlay_label_dir")+" "+(d+1)),s.childrenAmount={bookmarks:0,directories:0,total:0},c.forEach(function(e){t.directories[e].childrenAmount.directories++}),t.directories[s.id]=s,a(s.children,c,s.hidden),s.isDir=!0,s.childrenAmount.total=s.childrenAmount.bookmarks+s.childrenAmount.directories,s.views.perMonth=Math.round(s.views.total/u*100)/100)}})}(a),"function"==typeof s&&s()})},this.getAllDirectoryData=function(){return Object.values(t.directories)},this.getAllBookmarkData=function(){return Object.values(t.bookmarks)},this.getData=function(e){var a=null;return"object"===_typeof(t.bookmarks[e])?a=t.bookmarks[e]:"object"===_typeof(t.directories[e])&&(a=t.directories[e]),a},this.addData=function(e,a,s){"object"===_typeof(t.bookmarks[e])?t.bookmarks[e][a]=s:"object"===_typeof(t.directories[e])&&(t.directories[e][a]=s)},this.isVisible=function(e){var a=!1;return"object"===_typeof(t.bookmarks[e])?a=!1===t.bookmarks[e].hidden:"object"===_typeof(t.directories[e])&&(a=!1===t.directories[e].hidden),a}},window.FontHelper=function(t){var a=this,s={general:{name:"Roboto",href:"https://fonts.googleapis.com/css?family=Roboto:100,200,300,400,500,100i,200i,300i,400i,500i"},ja:{name:"Noto Sans Japanese",href:"https://fonts.googleapis.com/earlyaccess/notosansjapanese.css"},"zh-CN":{name:"Noto Sans SC",href:"https://fonts.googleapis.com/earlyaccess/notosanssc.css"}},r={__default:{Thin:100,ExtraLight:200,Light:300,Normal:400,Medium:500,SemiBold:600,Bold:700,ExtraBold:800,Black:900},Roboto:{Thin:100,ExtraLight:100,Light:200,Normal:300,Medium:400,SemiBold:400,Bold:500,ExtraBold:500,Black:500},"Noto Sans Japanese":{Thin:100,ExtraLight:100,Light:100,Normal:200,Medium:300,SemiBold:400,Bold:500,ExtraBold:500,Black:500},"Noto Sans SC":{Thin:100,ExtraLight:100,Light:100,Normal:300,Medium:400,SemiBold:400,Bold:400,ExtraBold:500,Black:500}},o={};this.init=function(){var e=t.helper.model.getData("a/styles");(o=e.fontFamily&&"default"!==e.fontFamily&&"Roboto"!==e.fontFamily?{name:e.fontFamily}:a.getDefaultFontInfo()).fontWeights=a.getFontWeights(o.name)},this.isLoaded=function(){return!!o.name},this.getFontInfo=function(){return o},this.getFontWeights=function(e){var t={};return Object.keys(r.__default).forEach(function(a){var s=r.__default[a];r[e]&&r[e][a]&&(s=r[e][a]),t["fontWeight"+a]=s}),t},this.addStylesheet=function(t){o.href&&e("<link />").attr({rel:"stylesheet",type:"text/css",href:o.href}).appendTo(t.find("head"))},this.getDefaultFontInfo=function(){var e=t.helper.i18n.getLanguage();return s[e]?s[e]:s.general}},window.I18nHelper=function(t){var a=this,s=null,r={},o={i18n:"data-i18n",i18nReplaces:"data-i18nReplaces"};this.init=function(e){r={},t.helper.model.call("languageInfos",function(o){var n=t.helper.model.getData("a/language");"default"===n&&(n=chrome.i18n.getUILanguage());var l=a.getDefaultLanguage();[n,l].some(function(a){if(o.infos&&o.infos[a]&&o.infos[a].available)return s=a,t.helper.model.call("langvars",{lang:a,defaultLang:l},function(t){t&&t.langVars&&(r=t.langVars,"function"==typeof e&&e())}),!0})})},this.getLanguage=function(){return s},this.getDefaultLanguage=function(){return t.opts.manifest.default_locale},this.getLocaleSortCollator=function(){return new Intl.Collator([chrome.i18n.getUILanguage(),a.getDefaultLanguage()])},this.getLocaleDate=function(e){return e.toLocaleDateString([chrome.i18n.getUILanguage(),a.getDefaultLanguage()],{year:"numeric",month:"2-digit",day:"2-digit"})},this.parseHtml=function(t){e(t).find("["+o.i18n+"]").forEach(function(t){var s=null,r=e(t).attr(o.i18n);if(r){var n=[],l=e(t).attr(o.i18nReplaces);l&&(n=l.split(",")),s=a.get(r,n)}s?(e(t).removeAttr(o.i18n),e(t).html(s)):e(t).remove()})},this.get=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a="",s=r[e];return s&&s.message&&(a=s.message,t.forEach(function(e,t){a=a.replace(new RegExp("\\{"+(t+1)+"\\}"),e)}),a=a.replace(/\[b\](.*)\[\/b\]/,"<strong>$1</strong>"),a=a.replace(/\[a\](.*)\[\/a\]/,"<a href='#'>$1</a>"),a=a.replace(/\[em\](.*)\[\/em\]/,"<em>$1</em>")),a}},window.ListHelper=function(t){var a=this,s=0,r=null;this.init=function(){t.elements.bookmarkBox.all.addClass(t.opts.classes.sidebar.active),Object.values(t.elements.bookmarkBox).forEach(function(e){e.on(t.opts.events.scrollBoxLastPart,function(){var s=e.children("ul"),r=s.data("remainingEntries");r&&r.length>0&&(a.addBookmarkDir(r,s,!1,!1),(t.refreshRun||!1===t.elements.iframe.hasClass(t.opts.classes.page.visible))&&t.helper.scroll.restoreScrollPos(e))})}),a.updateBookmarkBox()},this.getSortList=function(){return{custom:{dir:"ASC"},alphabetical:{dir:"ASC"},mostUsed:{dir:"DESC"},recentlyUsed:{dir:"DESC"},recentlyAdded:{dir:"DESC"}}},this.getSort=function(){return r},this.updateSort=function(e,s){var o=a.getSortList();o[e]&&(void 0===s&&(s=o[e].dir),r={name:e,dir:"ASC"===s?"ASC":"DESC"},t.startLoading(),t.helper.model.setData({"u/sort":r},function(){t.helper.model.call("trackEvent",{category:"sorting",action:"change",label:r.name+"_"+r.dir}),t.helper.model.call("refreshAllTabs",{scrollTop:!0,type:"Sort"})}))},this.updateDirection=function(e){a.updateSort(r.name,e)},this.updateBookmarkBox=function(){t.startLoading(),r=t.helper.model.getData("u/sort"),t.elements.sidebar.attr(t.opts.attr.sort,r.name),t.helper.model.call("bookmarks",{id:0},function(e){if(e.bookmarks&&e.bookmarks[0]&&e.bookmarks[0].children&&e.bookmarks[0].children.length>0){t.refreshRun=!0;var s=t.elements.bookmarkBox.all.children("ul");s.removeClass(t.opts.classes.sidebar.hideRoot).text(""),t.helper.entry.update(e.bookmarks[0].children,function(){i(),a.updateSortFilter(),t.helper.search.init(),t.helper.model.getData("u/viewAsTree")||"custom"===r.name?a.addBookmarkDir(e.bookmarks[0].children,s,!0):a.addBookmarkDir(t.helper.entry.getAllBookmarkData(),s,!1),1===s.children("li").length()?(s.addClass(t.opts.classes.sidebar.hideRoot),a.toggleBookmarkDir(s.find("> li > a."+t.opts.classes.sidebar.bookmarkDir).eq(0))):a.restoreOpenStates(s)})}}),t.helper.scroll.focus()},this.toggleBookmarkDir=function(s,r,o){s.addClass(t.opts.classes.sidebar.dirAnimated);var l=s.attr(t.opts.attr.id),i=s.next("ul");void 0===r&&(r=!0===t.refreshRun||!1===t.elements.iframe.hasClass(t.opts.classes.page.visible)),s.hasClass(t.opts.classes.sidebar.dirOpened)?n(s,i,!1,r,o):(t.helper.model.getData("b/dirAccordion")&&t.elements.bookmarkBox.all.find("a."+t.opts.classes.sidebar.dirOpened).forEach(function(s){0===e(s).next("ul").find("a["+t.opts.attr.id+"='"+l+"']").length()&&a.toggleBookmarkDir(e(s),r)}),0===i.length()?t.helper.model.call("bookmarks",{id:l},function(t){t.bookmarks&&t.bookmarks[0]&&t.bookmarks[0].children&&t.bookmarks[0].children.length>0&&(i=e("<ul />").insertAfter(s),a.addBookmarkDir(t.bookmarks[0].children,i),n(s,i,!0,r,o))}):n(s,i,!0,r,o))},this.restoreOpenStates=function(e){var r=0,o=t.helper.model.getData(["b/rememberState","u/openStates"]);"all"!==o.rememberState&&"openStates"!==o.rememberState&&"openStatesRoot"!==o.rememberState||(s++,Object.keys(o.openStates).forEach(function(s){if(!0===o.openStates[s]){var n=e.find("> li > a."+t.opts.classes.sidebar.bookmarkDir+"["+t.opts.attr.id+"='"+s+"']");n.length()>0&&("openStatesRoot"===o.rememberState&&1!==n.parents("ul").length()||(r++,a.toggleBookmarkDir(n)))}}),s--),0===r&&0===s&&setTimeout(function(){t.helper.scroll.restoreScrollPos(t.elements.bookmarkBox.all,function(){t.initImages(),t.endLoading(200),t.firstRun=!1,t.refreshRun=!1,t.loaded()})},100)},this.updateSortFilter=function(){t.elements.filterBox.removeClass(t.opts.classes.sidebar.hidden).text("");var a=0;if("custom"===r.name)t.elements.filterBox.addClass(t.opts.classes.sidebar.hidden);else{var s=t.helper.model.getData(["u/viewAsTree","u/mostViewedPerMonth"]),o=r.name.replace(/([A-Z])/g,"_$1").toLowerCase();e("<a />").attr(t.opts.attr.direction,r.dir).text(t.helper.i18n.get("sort_label_"+o)).appendTo(t.elements.filterBox);var n=e("<ul />").appendTo(t.elements.filterBox);if(!t.elements.bookmarkBox.search.hasClass(t.opts.classes.sidebar.active)){var l;e("<li />").append(t.helper.checkbox.get(t.elements.iframeBody,(l={},_defineProperty(l,t.opts.attr.name,"viewAsTree"),_defineProperty(l,"checked",s.viewAsTree?"checked":""),l))).append("<a>"+t.helper.i18n.get("sort_view_as_tree")+"</a>").appendTo(n)}if("mostUsed"===r.name){var i;e("<li />").append(t.helper.checkbox.get(t.elements.iframeBody,(i={},_defineProperty(i,t.opts.attr.name,"mostViewedPerMonth"),_defineProperty(i,"checked",s.mostViewedPerMonth?"checked":""),i))).append("<a>"+t.helper.i18n.get("sort_most_used_per_month")+"</a>").appendTo(n)}0===n.children("li").length()&&n.remove(),a=t.elements.filterBox.realHeight()}Object.values(t.elements.bookmarkBox).forEach(function(e){e.css("padding-top",a)})},this.addBookmarkDir=function(a,s){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!1,d=t.helper.model.getData(["a/showBookmarkIcons","b/dirOpenDuration"]),c=t.elements.iframe.hasClass(t.opts.classes.page.visible),p=t.elements.sidebar.hasClass(t.opts.classes.sidebar.showHidden);if(s.parents("li").length()>0&&s.css("transition","height "+d.dirOpenDuration+"s"),n&&"custom"===r.name&&s.prev("a").length()>0){var u=s.prev("a").attr("data-id"),h=t.helper.model.getData("u/separators");h[u]&&h[u].forEach(function(e){e.separator=!0,e.parentId=u,a.push(e)})}var m=0;return s.removeData("remainingEntries"),l&&o(a),a.some(function(r,o){if((p||r.separator||t.helper.entry.isVisible(r.id))&&(r.children||r.url||r.separator)){t.opts.demoMode&&(r.children?r.title="Directory "+(o+1):(r.title="Bookmark "+(o+1),r.url="https://example.com/"));var l=e("<li />").appendTo(s),u=e("<a />").html("<span class='"+t.opts.classes.sidebar.bookmarkLabel+"'>"+(r.title||"")+"</span><span class='"+t.opts.classes.drag.trigger+"' />").appendTo(l);if(r.id&&u.attr(t.opts.attr.id,r.id),r.separator||!1!==t.helper.entry.isVisible(r.id)||l.addClass(t.opts.classes.sidebar.hidden),t.helper.entry.addData(r.id,"element",u),r.children&&n?(u.attr("title",r.title+"\n-------------\n"+r.children.length+" "+t.helper.i18n.get("sidebar_dir_children")).addClass(t.opts.classes.sidebar.bookmarkDir),d.showBookmarkIcons&&u.prepend("<span class='"+t.opts.classes.sidebar.dirIcon+"' />")):r.url?(u.attr("title",r.title+"\n-------------\n"+r.url).addClass(t.opts.classes.sidebar.bookmarkLink),d.showBookmarkIcons&&(t.opts.demoMode?u.prepend("<span class='"+t.opts.classes.sidebar.dirIcon+"' data-color='"+(Math.floor(10*Math.random())+1)+"' />"):t.helper.model.call("favicon",{url:r.url},function(e){e.img&&(t.helper.entry.addData(r.id,"icon",e.img),u.prepend("<img "+(c?"src":t.opts.attr.src)+"='"+e.img+"' />"))})),m++):r.separator&&u.addClass(t.opts.classes.sidebar.separator).data("infos",{id:r.parentId,index:r.index}),i=!0,!1===n&&m>=100){var h=a.slice(100);return h.length>0&&s.data("remainingEntries",h),!0}}}),i};var o=function(e){if(e.length>1){var a=t.helper.i18n.getLocaleSortCollator(),s=function(t,a){e.sort(function(e,s){return"custom"!==r.name&&!!e.children!=!!s.children?e.children?-1:1:(t===r.dir?1:-1)*a(e,s)})};switch(r.name){case"custom":s("ASC",function(e,t){return e.index-(e.separator?.5:0)-(t.index-(t.separator?.5:0))});break;case"alphabetical":s("ASC",function(e,t){return a.compare(e.title,t.title)});break;case"recentlyAdded":s("DESC",function(e,t){return t.dateAdded-e.dateAdded});break;case"mostUsed":var o=t.helper.model.getData("u/mostViewedPerMonth");s("DESC",function(e,s){var r=t.helper.entry.getData(e.id),n=t.helper.entry.getData(s.id),l=r?r.views[o?"perMonth":"total"]:0,i=n?n.views[o?"perMonth":"total"]:0;return l===i?a.compare(e.title,s.title):i-l});break;case"recentlyUsed":s("DESC",function(e,s){var r=t.helper.entry.getData(e.id),o=t.helper.entry.getData(s.id),n=r?r.views.lastView:0,l=o?o.views.lastView:0;return n===l?a.compare(e.title,s.title):l-n})}}},n=function(e,s,r,o,n){var i=t.firstRun;if(s.css("height",s[0].scrollHeight+"px"),!1===r&&setTimeout(function(){s.css("height",0)},0),!0===t.refreshRun)a.restoreOpenStates(s);else{var d=t.helper.model.getData("u/openStates");d[e.attr(t.opts.attr.id)]=r,!1===r?l(e,d):t.helper.model.setData({"u/openStates":d})}var c=t.helper.model.getData("b/dirOpenDuration");setTimeout(function(){!1===r?e.removeClass(t.opts.classes.sidebar.dirOpened):(e.addClass(t.opts.classes.sidebar.dirOpened),t.helper.model.getData("b/dirAccordion")&&t.helper.scroll.setScrollPos(t.elements.bookmarkBox.all,e[0].offsetTop,300)),s.css("height",""),e.removeClass(t.opts.classes.sidebar.dirAnimated),i||t.helper.model.call("trackEvent",{category:"directory",action:"openState_change",label:r?"open":"close"}),"function"==typeof n&&n()},o?0:1e3*+c)},l=function(a,s){a.next("ul").find("a."+t.opts.classes.sidebar.bookmarkDir).forEach(function(a){s[e(a).attr(t.opts.attr.id)]=!1,setTimeout(function(){e(a).removeClass(t.opts.classes.sidebar.dirOpened)},500)}),t.helper.model.setData({"u/openStates":s})},i=function(){t.elements.header.text("");var a=t.helper.entry.getAllBookmarkData().length,s=e("<h1 />").html("<strong>"+a+"</strong> <span>"+t.helper.i18n.get("header_bookmarks"+(1===a?"_single":""))+"</span>").attr("title",a+" "+t.helper.i18n.get("header_bookmarks"+(1===a?"_single":""))).appendTo(t.elements.header),r=[];r.push(e("<a />").addClass(t.opts.classes.sidebar.menu).appendTo(t.elements.header)),r.push(e("<a />").addClass(t.opts.classes.sidebar.sort).appendTo(t.elements.header)),r.push(e("<a />").addClass(t.opts.classes.sidebar.search).appendTo(t.elements.header));var o=window.getComputedStyle(t.elements.header[0]),n=parseInt(o.getPropertyValue("padding-top"));r.some(function(e){if(e[0].offsetTop>n)return s.children("span").addClass(t.opts.classes.sidebar.hidden),!0}),e("<div />").addClass(t.opts.classes.sidebar.searchBox).append("<input type='text' placeholder='"+t.helper.i18n.get("sidebar_search_placeholder")+"' />").append("<a class='"+t.opts.classes.sidebar.searchClose+"'></a>").appendTo(t.elements.header)}},window.ModelHelper=function(e){var t=this,a={textColor:{light:"rgb(100,100,100)",dark:"rgb(200,200,200)"},sidebarMaskColor:{light:"rgba(255,255,255,0.8)",dark:"rgba(0,0,0,0.6)"},colorScheme:{light:"rgb(27,130,241)",dark:"rgb(31, 77, 128)"}},s={u:{openStates:{},hiddenEntries:{},scrollPos:{},separators:{},entriesLocked:!1,sort:{name:"custom",dir:"ASC"},mostViewedPerMonth:!1,viewAsTree:!0},b:{pxTolerance:{windowed:20,maximized:1},openAction:"mousedown",newTab:"foreground",linkAction:"current",preventPageScroll:!1,dirAccordion:!1,rememberState:"all",rememberSearch:!0,dirOpenDuration:.5,openDelay:0,closeTimeout:1,initialOpenOnNewTab:!1},a:{sidebarPosition:"left",language:"default",showIndicator:!0,showIndicatorIcon:!0,darkMode:!1,showBookmarkIcons:!0,styles:{colorScheme:a.colorScheme.light,textColor:a.textColor.light,indicatorWidth:"40px",indicatorIconSize:"32px",indicatorIconColor:"rgb(255,255,255)",indicatorColor:"rgba(0,0,0,0.5)",sidebarWidth:"350px",sidebarMaskColor:a.sidebarMaskColor.light,bookmarksFontSize:"14px",bookmarksIconSize:"16px",bookmarksLineHeight:"40px",bookmarksDirIcon:"dir-1",bookmarksDirColor:a.textColor.light,bookmarksDirIndentation:"25px",bookmarksHorizontalPadding:"16px",overlayMaskColor:"rgba(0,0,0,0.5)",fontFamily:"default"}}},r={};this.init=function(e){var t=["utility","behaviour","appearance"];chrome.storage.sync.get(t,function(a){r=a,t.forEach(function(e){void 0===r[e]&&(r[e]={})}),"function"==typeof e&&e()})},this.getData=function(t){var a=t;"string"==typeof a&&(a=[a]);var o={};if(a.forEach(function(t){var a=t.split("/")[0],n=t.split("/")[1],l=null,i=null;switch(a){case"u":i=r.utility;break;case"b":i=r.behaviour;break;case"a":i=r.appearance}if(null!==i&&(void 0===i[n]?void 0!==s[a]&&void 0!==s[a][n]&&(l=s[a][n]):l=i[n]),"a/styles"===t){if(l=Object.assign({},s.a.styles,l),e.helper.font&&e.helper.font.isLoaded()){var d=e.helper.font.getFontInfo();l.fontFamily=d.name,Object.assign(l,d.fontWeights)}"__color_ee"===l.colorScheme&&(l.isEE=!0,l.colorScheme="#7b5fa4")}o[n]=l}),"string"==typeof t){var n=t.split("/")[1];o=o[n]}return o},this.setData=function(e,a){t.init(function(){Object.keys(e).forEach(function(t){var a=t.split("/")[0],s=t.split("/")[1],o=e[t];switch(a){case"u":r.utility[s]=o,r.utility;break;case"b":r.behaviour[s]=o;break;case"a":r.appearance[s]=o}});try{chrome.storage.sync.set(r,function(){"function"==typeof a&&a()})}catch(e){"function"==typeof a&&a()}})},this.call=function(e,t,a){"function"==typeof t&&(a=t,t={}),t.type=e,chrome.extension.sendMessage(t,function(e){"function"==typeof a&&a(e)})},this.getDefaultColor=function(e,t){return a[e]?t&&a[e][t]?a[e][t]:a[e].light:null}},window.OverlayHelper=function(t){var a={};this.create=function(s,r,p){a.overlay=e("<iframe />").attr("id",t.opts.ids.page.overlay).appendTo("body"),t.helper.stylesheet.addStylesheets(["overlay"],a.overlay);var h=a.overlay.find("body");a.modal=e("<div />").attr(t.opts.attr.type,s).addClass(t.opts.classes.overlay.modal).appendTo(h),!0===t.helper.model.getData("a/darkMode")&&h.addClass(t.opts.classes.page.darkMode);var m=s;switch(a.modal.append("<h1>"+r+"</h1>"),e("<a />").addClass(t.opts.classes.overlay.close).appendTo(a.modal),a.buttonWrapper=e("<menu />").addClass(t.opts.classes.overlay.buttonWrapper).appendTo(a.modal),e("<a />").addClass(t.opts.classes.overlay.close).text(t.helper.i18n.get("overlay_"+("infos"===s?"close":"cancel"))).appendTo(a.buttonWrapper),s){case"delete":o(p);break;case"edit":n(p);break;case"infos":c(p);break;case"add":d(p);break;case"hide":i(p);break;case"openChildren":l(p);break;case"updateUrls":u(p)}t.helper.model.call("trackPageView",{page:"/overlay/"+m}),y(p),setTimeout(function(){a.modal.addClass(t.opts.classes.overlay.visible),a.overlay.addClass(t.opts.classes.page.visible)},100)};var s=function(){t.helper.model.call("realUrl",{abort:!0}),t.elements.bookmarkBox.all.find("li."+t.opts.classes.drag.isDragged).remove(),a.overlay.removeClass(t.opts.classes.page.visible),setTimeout(function(){a.overlay.remove()},500)},r=function(s,r){var o=e("<"+(s.isDir?"span":"a")+" />").attr("title",s.title+(s.url?"\n"+s.url:"")).addClass(t.opts.classes.overlay.preview).html(s.title).appendTo(a.modal);s.isDir?o.prepend("<span class='"+t.opts.classes.sidebar.dirIcon+"' />"):s.icon?o.prepend("<img src='"+s.icon+"' />"):t.opts.demoMode&&o.prepend("<span class='"+t.opts.classes.sidebar.dirIcon+"' data-color='"+(Math.floor(10*Math.random())+1)+"' />"),r&&!0===r&&!0!==s.isDir&&e("<a />").addClass(t.opts.classes.overlay.previewUrl).attr("title",s.url).text(s.url).insertAfter(o)},o=function(s){e("<p />").text(t.helper.i18n.get("overlay_delete_"+(s.isDir?"dir":"bookmark")+"_confirm")).appendTo(a.modal),r(s),e("<a />").addClass(t.opts.classes.overlay.action).text(t.helper.i18n.get("overlay_delete")).appendTo(a.buttonWrapper)},n=function(s){r(s);var o=e("<ul />").appendTo(a.modal);o.append("<li><label>"+t.helper.i18n.get("overlay_bookmark_title")+"</label><input type='text' name='title' value='"+s.title+"' /></li>"),s.isDir||o.append("<li><label>"+t.helper.i18n.get("overlay_bookmark_url")+"</label><input type='text' name='url' value='"+s.url+"' /></li>"),e("<a />").addClass(t.opts.classes.overlay.action).text(t.helper.i18n.get("overlay_save")).appendTo(a.buttonWrapper)},l=function(s){var o=s.children.filter(function(e){return!!e.url}),n=t.helper.i18n.get("overlay_confirm_open_children",[o.length]);e("<p />").text(n).appendTo(a.modal),r(s),e("<a />").addClass(t.opts.classes.overlay.action).text(t.helper.i18n.get("overlay_open_children")).appendTo(a.buttonWrapper)},i=function(s){e("<p />").text(t.helper.i18n.get("overlay_hide_"+(s.isDir?"dir":"bookmark")+"_confirm")).appendTo(a.modal),r(s),e("<a />").addClass(t.opts.classes.overlay.action).text(t.helper.i18n.get("overlay_hide_from_sidebar")).appendTo(a.buttonWrapper)},d=function(r){var o=e("<a />").addClass(t.opts.classes.overlay.action).text(t.helper.i18n.get("overlay_save")).appendTo(a.buttonWrapper),n=e("<menu />").appendTo(a.modal),l=e("<a />").attr(t.opts.attr.type,"bookmark").attr("title",t.helper.i18n.get("overlay_label_bookmark")).appendTo(n);e("<a />").attr(t.opts.attr.type,"dir").attr("title",t.helper.i18n.get("overlay_label_dir")).appendTo(n),e("<a />").attr(t.opts.attr.type,"separator").attr("title",t.helper.i18n.get("overlay_label_separator")).appendTo(n),n.children("a").on("click",function(l){l.preventDefault();var i=e(l.currentTarget).attr(t.opts.attr.type);if("separator"===i)t.helper.utility.addSeparator({id:r.id,index:0},function(){s(),t.helper.model.call("refreshAllTabs",{type:"Separator"})});else{var d=e("<ul />").appendTo(a.modal),c="",p="";"bookmark"===i&&(c=e(document).find("title").text(),p=location.href),r&&r.values&&(r.values.title&&(c=r.values.title),r.values.url&&(p=r.values.url)),d.append("<li><h2>"+e(l.currentTarget).attr("title")+"</h2></li>"),d.append("<li><label>"+t.helper.i18n.get("overlay_bookmark_title")+"</label><input type='text' name='title' value='"+c+"' /></li>"),"bookmark"===i&&d.append("<li><label>"+t.helper.i18n.get("overlay_bookmark_url")+"</label><input type='text' name='url' value='"+p+"'  /></li>"),n.addClass(t.opts.classes.sidebar.hidden),setTimeout(function(){d.addClass(t.opts.classes.overlay.visible),o.addClass(t.opts.classes.overlay.visible)},r&&r.values?0:100)}}),r&&r.values&&l.trigger("click")},c=function(s){r(s,!0);var o=e("<ul />").appendTo(a.modal),n=new Date(s.dateAdded);if(e("<li />").html(t.helper.i18n.get("overlay_bookmark_created_date")+" "+t.helper.i18n.getLocaleDate(n)).appendTo(o),s.isDir){var l=e("<li />").addClass(t.opts.classes.overlay.hasTooltip).append("<span>"+s.childrenAmount.total+"</span>").append(" "+t.helper.i18n.get("overlay_dir_children"),!1).appendTo(o);e("<ul />").append("<li>"+s.childrenAmount.bookmarks+" "+t.helper.i18n.get("overlay_dir_children_bookmarks")+"</li>").append("<li>"+s.childrenAmount.directories+" "+t.helper.i18n.get("overlay_dir_children_dirs")+"</li>").appendTo(l)}var i=e("<li />").addClass(t.opts.classes.overlay.hasTooltip).append("<span>"+s.views.total+"</span>").append(" "+t.helper.i18n.get("overlay_bookmark_views"+(1===s.views.total?"_single":"")),!1).appendTo(o);e("<ul />").append("<li>"+t.helper.i18n.get("overlay_bookmark_views_since")+" "+t.helper.i18n.getLocaleDate(s.views.startDate)+"</li>").append("<li>"+s.views.perMonth+" "+t.helper.i18n.get("overlay_bookmark_views"+(1===s.views.perMonth?"_single":""))+" "+t.helper.i18n.get("overlay_bookmark_views_per_month")+"</li>").appendTo(i)},p=function(s){var r=s.length>0;setTimeout(function(){a.desc.remove(),a.progressBar.remove(),a.progressLabel.remove(),r&&a.modal.addClass(t.opts.classes.overlay.urlCheckList),setTimeout(function(){if(a.loader.remove(),a.modal.removeClass(t.opts.classes.overlay.urlCheckLoading),a.buttonWrapper.children("a."+t.opts.classes.overlay.close).text(t.helper.i18n.get("overlay_close")),0===s.length)e("<p />").addClass(t.opts.classes.overlay.success).text(t.helper.i18n.get("overlay_check_urls_no_results")).appendTo(a.modal);else{e("<a />").addClass(t.opts.classes.overlay.action).text(t.helper.i18n.get("overlay_update")).appendTo(a.buttonWrapper);var r=t.helper.scroll.add(t.opts.ids.overlay.urlList,e("<ul />").appendTo(a.modal)),o=a.overlay.find("body");s.forEach(function(a){var s=e("<li />").data("entry",a).append(t.helper.checkbox.get(o,{checked:"checked"})).append("<strong>"+a.title+"</strong>");e("<a />").attr({href:a.url,title:a.url,target:"_blank"}).html("<span>"+a.url+"</span>").appendTo(s),404===a.urlStatusCode?e("<span />").text(t.helper.i18n.get("overlay_check_urls_not_found")).appendTo(s):a.newUrl!==a.url&&e("<a />").attr({href:a.newUrl,title:a.newUrl,target:"_blank"}).html("<span>"+a.newUrl+"</span>").appendTo(s),s=s.appendTo(r.children("ul")),t.helper.model.call("favicon",{url:a.url},function(a){a.img&&e("<img src='"+a.img+"' />").insertAfter(s.children("div."+t.opts.classes.checkbox.box))})})}},r?1e3:0)},1e3)},u=function(s){var r=[];!function e(t){t.forEach(function(t){t.url?r.push(t):t.children&&e(t.children)})}(s.children);var o=r.length;a.desc=e("<p />").text(t.helper.i18n.get("overlay_check_urls_loading")).appendTo(a.modal),a.progressBar=e("<div />").addClass(t.opts.classes.overlay.progressBar).html("<div />").appendTo(a.modal),a.progressLabel=e("<span />").addClass(t.opts.classes.overlay.checkUrlProgressLabel).html("<span>0</span>/<span>"+o+"</span>").appendTo(a.modal),a.loader=t.helper.template.loading().appendTo(a.modal),setTimeout(function(){a.modal.addClass(t.opts.classes.overlay.urlCheckLoading)},500);var n=0,l=[];r.forEach(function(e){t.helper.model.call("realUrl",{url:e.url},function(t){n++,a.progressBar.children("div").css("width",n/o*100+"%"),a.progressLabel.children("span").eq(0).text(n),(404==+t.code||e.url!==t.url&&302!=+t.code)&&(e.newUrl=t.url,e.urlStatusCode=+t.code,l.push(e)),n===o&&p(l)})})},h=function(e){s();var a=e.children.filter(function(e){return!!e.url});t.helper.model.call("trackEvent",{category:"url",action:"open",label:"new_tab_all_children",value:a.length}),a.forEach(function(e){t.helper.utility.openUrl(e,"newTab","foreground"===t.helper.model.getData("b/newTab"))})},m=function(e){t.startLoading(),s();var a=t.helper.model.getData("u/hiddenEntries");a[e.id]=!0,t.helper.model.setData({"u/hiddenEntries":a},function(){t.helper.model.call("refreshAllTabs",{type:"Hide"})})},f=function(e){s(),t.helper.model.call("deleteBookmark",{id:e.id},function(){e.element.parent("li").remove()})},g=function(e){var s=a.modal.find("input[name='title']").removeClass(t.opts.classes.overlay.inputError),r=a.modal.find("input[name='url']").removeClass(t.opts.classes.overlay.inputError),o={errors:!1,values:{title:s[0].value.trim(),url:e?null:r[0].value.trim()}};return 0===o.values.title.length&&(s.addClass(t.opts.classes.overlay.inputError),o.errors=!0),e||0!==o.values.url.length||(r.addClass(t.opts.classes.overlay.inputError),o.errors=!0),null!==o.values.url&&0!==o.values.url.search(/^\w+\:\/\//)&&(o.values.url="http://"+o.values.url),o},v=function(e){var r=g(e.isDir);!1===r.errors&&t.helper.model.call("updateBookmark",{id:e.id,title:r.values.title,url:r.values.url},function(o){o.error?a.modal.find("input[name='url']").addClass(t.opts.classes.overlay.inputError):(s(),e.title=r.values.title,e.url=r.values.url,e.element.children("span."+t.opts.classes.sidebar.bookmarkLabel).text(e.title))})},b=function(e){var r=g(0===a.modal.find("input[name='url']").length());if(!1===r.errors){var o={title:r.values.title,url:r.values.url,parentId:e.id||null,index:0};e&&e.values&&(e.values.index&&(o.index=e.values.index),e.values.parentId&&(o.parentId=e.values.parentId)),t.helper.model.call("createBookmark",o,function(e){e.error?a.modal.find("input[name='url']").addClass(t.opts.classes.overlay.inputError):s()})}},k=function(){a.modal.find("div#"+t.opts.ids.overlay.urlList+" ul > li").forEach(function(a){if(e(a).find("input[type='checkbox']")[0].checked){var s=e(a).data("entry");404===s.urlStatusCode?t.helper.model.call("deleteBookmark",{id:s.id}):s.url!==s.newUrl&&t.helper.model.call("updateBookmark",{id:s.id,title:s.title,url:s.newUrl})}}),s()},y=function(r){a.overlay.find("body").on("click",function(e){"BODY"===e.target.tagName&&s()}),a.modal.find("a."+t.opts.classes.overlay.close).on("click",function(e){e.preventDefault(),s()}),a.modal.on("click","a."+t.opts.classes.overlay.action,function(e){switch(e.preventDefault(),a.modal.attr(t.opts.attr.type)){case"delete":f(r);break;case"hide":m(r);break;case"openChildren":h(r);break;case"edit":v(r);break;case"add":b(r);break;case"updateUrls":k()}}),a.modal.on("focus","input",function(a){e(a.currentTarget).removeClass(t.opts.classes.overlay.inputError)}),a.modal.find("a."+t.opts.classes.overlay.preview+", a."+t.opts.classes.overlay.previewUrl).on("click",function(e){e.preventDefault(),t.helper.model.call("trackEvent",{category:"url",action:"open",label:"new_tab_overlay"}),t.helper.utility.openUrl(r,"newTab")})}},window.ScrollHelper=function(t){var a=this,s=+new Date,r={},o=[];this.add=function(a,s){var r=e("<div id='"+a+"' class='"+t.opts.classes.scrollBox.wrapper+"' tabindex='0' />").insertBefore(s);return s=s.appendTo(r),r.data({list:s}),o.push(r),d(r),r},this.focus=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!t.elements.iframe.hasClass(t.opts.classes.page.visible)||e&&t.elements.header.find("div."+t.opts.classes.sidebar.searchBox+" > input[type='text']")[0]===t.elements.iframe[0].contentDocument.activeElement||o.forEach(function(e){e.hasClass(t.opts.classes.sidebar.active)&&e[0].focus()})},this.updateAll=function(){o.forEach(function(e){e.hasClass(t.opts.classes.sidebar.active)&&a.update(e)})},this.restoreScrollPos=function(e,s){var r=t.helper.model.getData(["b/rememberState","u/scrollPos"]);"all"===r.rememberState?(a.setScrollPos(e,r.scrollPos[e.attr("id")]||0),setTimeout(function(){"function"==typeof s&&s()},100)):"function"==typeof s&&s()},this.setScrollPos=function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===s)e[0].scrollTop=t,a.update(e);else{var r=e[0].scrollTop,o=0;!function n(){var l=(o+=1/60)/(s/1e3),i=Math.sin(l*(Math.PI/2));l<1?(window.requestAnimationFrame(n),e[0].scrollTop=r+(t-r)*i):(e[0].scrollTop=t,a.update(e))}()}};var n=function(t){var a=0;return t.children().forEach(function(t){a+=e(t).realHeight(!0)}),a},l=function(e){if(!1===t.refreshRun&&+new Date-s>500){s=+new Date;var a=t.helper.model.getData("u/scrollPos");a[e.attr("id")]=e[0].scrollTop,t.helper.model.setData({"u/scrollPos":a})}};this.update=function(e){t.helper.contextmenu.close(),l(e);var a=i(e),s=n(e),o=e[0].scrollTop;o>10?e.addClass(t.opts.classes.scrollBox.scrolled):e.removeClass(t.opts.classes.scrollBox.scrolled);var d=e.data("lastPos")||0;o>d?e.attr(t.opts.attr.direction,"down"):o<d?e.attr(t.opts.attr.direction,"up"):e.removeAttr(t.opts.attr.direction),e.data("lastPos",o),(s-o<2*a||s===o&&0===a)&&e.trigger(t.opts.events.scrollBoxLastPart),t.elements.iframe.hasClass(t.opts.classes.page.visible)?(e.removeClass(t.opts.classes.scrollBox.hideScrollbar),clearTimeout(r[e.attr("id")]),r[e.attr("id")]=setTimeout(function(){e.addClass(t.opts.classes.scrollBox.hideScrollbar)},1500)):e.addClass(t.opts.classes.scrollBox.hideScrollbar),t.helper.scroll.focus()};var i=function(e){return e.realHeight()-parseInt(e.css("padding-top"))},d=function(e){e.on("scroll",function(){a.update(e)})}},window.SearchHelper=function(t){var a=this,s=null;this.init=function(){var e=t.helper.model.getData(["b/rememberSearch","u/searchValue"]);e.rememberSearch&&e.searchValue&&e.searchValue.length>0&&(t.elements.header.addClass(t.opts.classes.sidebar.searchVisible),r(e.searchValue)),l()},this.clearSearch=function(){t.helper.contextmenu.close(),t.elements.header.removeClass(t.opts.classes.sidebar.searchVisible),r("")};var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=t.elements.header.find("div."+t.opts.classes.sidebar.searchBox+" > input[type='text']");null===e?e=a[0].value:a[0].value=e,e&&e.length>0?o(a,e):n(a)},o=function(a,r){var o=t.firstRun;t.elements.bookmarkBox.all.removeClass(t.opts.classes.sidebar.active).removeClass(t.opts.classes.scrollBox.scrolled),t.elements.bookmarkBox.search.addClass(t.opts.classes.sidebar.active),t.helper.scroll.focus(),t.helper.list.updateSortFilter(),r!==a.data("lastVal")&&(t.startLoading(),a.data("lastVal",r),s&&(clearTimeout(s),s=null),t.helper.model.setData({"u/searchValue":r},function(){t.helper.scroll.setScrollPos(t.elements.bookmarkBox.search,0),t.helper.model.call("searchBookmarks",{searchVal:r},function(a){t.elements.bookmarkBox.search.children("p").remove();var n=!1,l=t.elements.bookmarkBox.search.children("ul");l.text(""),a.bookmarks&&a.bookmarks.length>0&&(n=t.helper.list.addBookmarkDir(a.bookmarks,l,!1)),!1===n&&e("<p />").text(t.helper.i18n.get("sidebar_search_no_results")).appendTo(t.elements.bookmarkBox.search),o||(s=setTimeout(function(){t.helper.model.call("trackEvent",{category:"search",action:"search",label:"search",value:r.length})},500)),t.endLoading(500)})}))},n=function(e){e.removeData("lastVal"),t.helper.model.setData({"u/searchValue":null},function(){t.elements.bookmarkBox.search.hasClass(t.opts.classes.sidebar.active)&&(t.startLoading(),t.elements.bookmarkBox.all.addClass(t.opts.classes.sidebar.active),t.elements.bookmarkBox.search.removeClass(t.opts.classes.sidebar.active),t.helper.scroll.restoreScrollPos(t.elements.bookmarkBox.all),t.helper.scroll.focus(),t.endLoading()),t.helper.list.updateSortFilter()})},l=function(){t.elements.header.on("click","a."+t.opts.classes.sidebar.search,function(e){e.preventDefault(),e.stopPropagation(),t.helper.contextmenu.close(),t.elements.header.addClass(t.opts.classes.sidebar.searchVisible),t.elements.header.find("div."+t.opts.classes.sidebar.searchBox+" > input[type='text']")[0].focus()}),t.elements.header.on("keyup","div."+t.opts.classes.sidebar.searchBox+" > input[type='text']",function(e){e.preventDefault(),r()}),t.elements.header.on("click","a."+t.opts.classes.sidebar.searchClose,function(e){e.preventDefault(),e.stopPropagation(),a.clearSearch()})}},window.SidebarEventsHelper=function(t){this.init=function(){r(),s(),a(),o()};var a=function(){e([document,t.elements.iframe[0].contentDocument]).on("keydown",function(a){if(t.elements.iframe.hasClass(t.opts.classes.page.visible)){var s=["ArrowDown","ArrowUp","PageDown","PageUp","Home","End","Space"];if(s.indexOf(a.key)>-1||s.indexOf(a.code)>-1)t.helper.scroll.focus();else if("c"===a.key&&(a.ctrlKey||a.metaKey))a.preventDefault(),Object.values(t.elements.bookmarkBox).forEach(function(a){if(a.hasClass(t.opts.classes.sidebar.active)){var s=a.find("> ul a."+t.opts.classes.sidebar.hover).eq(0);if(s.length()>0){var r=t.helper.entry.getData(s.attr(t.opts.attr.id));if(r&&r.url&&t.copyToClipboard(r.url)){e(s).children("span."+t.opts.classes.sidebar.copied).remove();var o=e("<span />").addClass(t.opts.classes.sidebar.copied).text(t.helper.i18n.get("sidebar_copied_to_clipboard")).appendTo(s);setTimeout(function(){e(s).addClass(t.opts.classes.sidebar.copied),setTimeout(function(){e(s).removeClass(t.opts.classes.sidebar.copied),setTimeout(function(){o.remove()},500)},1500)},100)}}}});else{var r=t.elements.header.find("div."+t.opts.classes.sidebar.searchBox+" > input[type='text']");r.data("l",a.ctrlKey||a.metaKey?0:r[0].value.length),r[0].focus()}}}).on("keyup",function(){if(t.elements.iframe.hasClass(t.opts.classes.page.visible)){var e=t.elements.header.find("div."+t.opts.classes.sidebar.searchBox+" > input[type='text']"),a=e.data("l")||0,s=e[0].value;s.length>0&&!t.elements.header.hasClass(t.opts.classes.sidebar.searchVisible)?(t.helper.contextmenu.close(),t.elements.header.addClass(t.opts.classes.sidebar.searchVisible)):t.helper.scroll.focus(+a!==s.length)}})},s=function(){t.elements.filterBox.on("click","a["+t.opts.attr.direction+"]",function(a){a.preventDefault();var s="ASC"===e(a.target).attr(t.opts.attr.direction)?"DESC":"ASC";t.helper.list.updateDirection(s)}).on("click","div."+t.opts.classes.checkbox.box+" + a",function(a){a.preventDefault(),e(a.target).prev("div["+t.opts.attr.name+"]").trigger("click")}),e(t.elements.iframe[0].contentDocument).on(t.opts.events.checkboxChanged,function(e){var a=e.detail.checkbox.attr(t.opts.attr.name);"viewAsTree"!==a&&"mostViewedPerMonth"!==a||t.helper.model.setData(_defineProperty({},"u/"+a,e.detail.checked),function(){t.startLoading(),t.helper.model.call("refreshAllTabs",{scrollTop:!0,type:"Sort"})})})},r=function(){Object.values(t.elements.bookmarkBox).forEach(function(a){a.children("ul").on("click mousedown","a",function(a){if(a.preventDefault(),!e(a.target).hasClass(t.opts.classes.drag.trigger)&&!e(a.target).hasClass(t.opts.classes.sidebar.separator)&&(1===a.which&&"click"===a.type||2===a.which&&"mousedown"===a.type||t.refreshRun)){var s=e(a.currentTarget),r=t.helper.entry.getData(s.attr(t.opts.attr.id));if(r.isDir&&!s.hasClass(t.opts.classes.sidebar.dirAnimated))t.helper.list.toggleBookmarkDir(s);else if(!r.isDir){var o=t.helper.model.getData(["b/newTab","b/linkAction"]),n=2===a.which||"newtab"===o.linkAction;2===a.which?t.helper.model.call("trackEvent",{category:"url",action:"open",label:"new_tab_middle_click"}):t.helper.model.call("trackEvent",{category:"url",action:"open",label:(n?"new":"current")+"_tab_default"}),t.helper.utility.openUrl(r,n?"newTab":"default",!n||"foreground"===o.newTab)}}}).on("mouseover","a",function(s){a.find("> ul a."+t.opts.classes.sidebar.hover).removeClass(t.opts.classes.sidebar.hover),e(s.currentTarget).addClass(t.opts.classes.sidebar.hover).removeClass(t.opts.classes.sidebar.mark)}).on("contextmenu","a",function(a){a.preventDefault();var s="list";e(a.target).hasClass(t.opts.classes.sidebar.separator)&&(s="separator"),t.helper.contextmenu.create(s,e(a.currentTarget))}),a.children("ul").on("mouseleave",function(a){e(a.currentTarget).find("a."+t.opts.classes.sidebar.hover).removeClass(t.opts.classes.sidebar.hover)})})},o=function(){e(window).on("beforeunload",function(){t.elements.sidebar.hasClass(t.opts.classes.sidebar.openedOnce)&&t.helper.scroll.updateAll()}),t.elements.iframe.find("body").on("click",function(){t.helper.contextmenu.close()}),chrome.extension.onMessage.addListener(function(e){if(e&&e.action&&"refresh"===e.action){var a=0;e.scrollTop&&(t.helper.scroll.setScrollPos(t.elements.bookmarkBox.all,0),a=100),setTimeout(function(){t.refresh()},a)}}),["menu","sort"].forEach(function(a){t.elements.header.on("click contextmenu","a."+t.opts.classes.sidebar[a],function(s){s.preventDefault(),s.stopPropagation(),t.helper.contextmenu.create(a,e(s.currentTarget))})}),t.elements.iframeBody.on("click","#"+t.opts.ids.sidebar.shareUserdata+" a",function(a){a.preventDefault(),t.helper.model.call("shareUserdata",{share:e(a.currentTarget).data("accept")}),t.elements.iframeBody.find("div#"+t.opts.ids.sidebar.shareUserdata).addClass(t.opts.classes.sidebar.hidden)})}},window.StylesheetHelper=function(t){var a={};this.init=function(){a=t.helper.model.getData("a/styles")},this.addStylesheets=function(s){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===r?r=e(document):(t.helper.font.addStylesheet(r),a.isEE&&t.opts.classes&&t.opts.classes.page&&t.opts.classes.page.ee&&r.find("body").addClass(t.opts.classes.page.ee));var o=null;o=0===r.find("head").length()?r.find("body"):r.find("head"),s.forEach(function(e){var t=new XMLHttpRequest;t.open("GET",chrome.extension.getURL("css/"+e+".css"),!0),t.onload=function(){if(t.response){var e=t.response;Object.keys(a).forEach(function(t){e=e.replace(new RegExp('"?%'+t+'"?',"g"),a[t])}),o.append("<style>"+e+"</style>")}},t.send()})}},window.TemplateHelper=function(t){this.loading=function(){return e('<svg class="loading" width="36px" height="36px" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg"><circle fill="none" stroke-width="3" stroke-linecap="round" cx="18" cy="18" r="16"></circle></svg>')},this.footer=function(){var t=e('<footer> <a id="copyright" href="https://blockbyte.de/extensions" target="_blank">  &copy; <span class="created">2016</span>&ensp;<strong>Blockbyte</strong> </a></footer>'),a=+t.find("span.created").text(),s=(new Date).getFullYear();return s>a&&t.find("span.created").text(a+" - "+s),t}},window.ToggleHelper=function(t){var a=null,s=null,r=null,o=0,n=null,l=null,i={};this.init=function(){t.elements.toggle=e("<div />").attr("id",t.opts.ids.page.indicator).appendTo("body");var l=t.helper.model.getData(["b/pxTolerance","b/preventPageScroll","a/showIndicator","a/showIndicatorIcon","a/styles","a/sidebarPosition","b/openDelay","b/openAction","b/initialOpenOnNewTab"]);s=l.pxTolerance,o=1e3*+l.openDelay,a=l.sidebarPosition,r=l.preventPageScroll,t.elements.toggle.css("width",d()+"px"),t.elements.iframe.attr(t.opts.attr.position,a),t.elements.sidebar.attr(t.opts.attr.position,a),l.styles&&l.styles.indicatorWidth&&(n=parseInt(l.styles.indicatorWidth)),l.showIndicator&&"icon"!==l.openAction&&"mousemove"!==l.openAction&&(t.elements.toggle.addClass(t.opts.classes.page.visible).attr(t.opts.attr.position,a),l.showIndicatorIcon&&t.elements.toggle.addClass(t.opts.classes.page.indicatorIcon)),f(),c(),"newtab"===t.helper.utility.getPageType()&&(t.elements.toggle.addClass(t.opts.classes.page.isNewTab),t.elements.iframe.addClass(t.opts.classes.page.isNewTab),l.initialOpenOnNewTab&&m())};var d=function(){return s[t.isWindowed()?"windowed":"maximized"]},c=function(){e(window).on("resize",function(){t.elements.toggle.css("width",d()+"px")}),t.elements.iframe.find("body").on("click",function(e){if(e.pageX){var s=e.pageX;"right"===a&&(s="newtab"===t.helper.utility.getPageType()?t.elements.iframe.realWidth()-s:window.innerWidth-s+t.elements.sidebar.realWidth()-1),s>t.elements.sidebar.realWidth()&&t.elements.iframe.hasClass(t.opts.classes.page.visible)&&h()}}),e(document).on("click",function(e){e.isTrusted&&h()}),t.elements.sidebar.on("mouseleave",function(){if(0===e("iframe#"+t.opts.ids.page.overlay).length()&&!1===t.elements.iframeBody.hasClass(t.opts.classes.drag.isDragged)){var a=t.helper.model.getData("b/closeTimeout");-1!=+a&&(i.close=setTimeout(function(){!1===t.elements.iframeBody.hasClass(t.opts.classes.drag.isDragged)&&h()},1e3*+a))}}).on("mouseenter",function(){u("close")}),e([document,t.elements.iframe[0].contentDocument]).on("keydown",function(e){"Escape"!==e.key&&"Esc"!==e.key||!t.elements.iframe.hasClass(t.opts.classes.page.visible)||(e.preventDefault(),h())}),e(document).on("visibilitychange",function(){document.hidden&&0===e("iframe#"+t.opts.ids.page.overlay).length()&&(t.elements.toggle.removeClass(t.opts.classes.page.hover),t.elements.iframe.hasClass(t.opts.classes.page.visible)&&h())}).on("mouseout",function(){u("open")}).on("mousemove dragover",function(e){if(e.isTrusted&&p(e.pageX)){var a=+new Date-(l||0);i.indicator||(i.indicator=setTimeout(function(){t.elements.toggle.addClass(t.opts.classes.page.hover)},Math.max(o-a,0)))}else u("indicator"),t.elements.toggle.removeClass(t.opts.classes.page.hover)},{passive:!0}),chrome.extension.onMessage.addListener(function(e){e&&e.action&&"toggleSidebar"===e.action&&(t.elements.iframe.hasClass(t.opts.classes.page.visible)?h():m())});var s=t.helper.model.getData("b/openAction");"icon"!==s&&e(document).on(s+" dragover",function(e){e.isTrusted&&("dragover"===e.type||"mousedown"!==s||0===e.button)&&p(e.pageX)?(e.stopPropagation(),e.preventDefault(),"mousemove"===s?i.open||(i.open=setTimeout(function(){m()},o)):(0===o||null===l||+new Date-l>o)&&m()):u("open")})},p=function(e){var s=!1;if(void 0!==e&&null!==e){"right"===a&&(e=window.innerWidth-e-1);var r=d();t.elements.toggle.hasClass(t.opts.classes.page.hover)&&n>r&&(r=n),s=e<r}return!1===s?l=null:null===l&&(l=+new Date),s},u=function(e){i[e]&&(clearTimeout(i[e]),i[e]=null)},h=function(){u("close"),u("open"),t.helper.contextmenu.close(),t.elements.iframe.removeClass(t.opts.classes.page.visible),e("body").removeClass(t.opts.classes.page.noscroll),e(document).trigger("mousemove")},m=function(){t.helper.model.call("shareUserdataMask",function(e){e&&e.showMask?t.addShareUserdataMask():t.elements.sidebar.find("#"+t.opts.ids.sidebar.shareUserdata).remove()}),t.trackInitialEvents(),t.helper.model.call("trackPageView",{page:"/sidebar/"+t.helper.utility.getPageType()}),t.elements.iframe.addClass(t.opts.classes.page.visible),t.elements.sidebar.addClass(t.opts.classes.sidebar.openedOnce),t.initImages(),r&&e("body").addClass(t.opts.classes.page.noscroll),t.helper.scroll.focus(),e(document).trigger("mousemove")},f=function(){e(t.opts.leftsideBackSelector).length()>0?t.elements.toggle.addClass(t.opts.classes.page.hasLeftsideBack):e(document).on(t.opts.events.lsbLoaded,function(e){e.detail.showIndicator&&t.elements.toggle.addClass(t.opts.classes.page.hasLeftsideBack)})}},window.UtilityHelper=function(e){this.openUrl=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"incognito"===a?e.helper.model.call("openLink",{href:t.url,incognito:!0}):e.helper.model.call("openLink",{parentId:t.parentId,id:t.id,href:t.url,newTab:"newTab"===a,active:s})},this.getPageType=function(){var e=location.href,t="other",a={newtab:"https?://www.google..+/_/chrome/newtab",website:"https?://",chrome:"chrome://",extension:"chrome-extension://",local:"file://"};return Object.keys(a).some(function(s){if(0===e.search(new RegExp(a[s],"gi")))return t=s,!0}),t},this.addSeparator=function(t,a){var s=e.helper.model.getData("u/separators");void 0===s[t.id]&&(s[t.id]=[]),s[t.id].push({index:t.index||0}),e.helper.model.setData({"u/separators":s},function(){"function"==typeof a&&a()})},this.removeSeparator=function(t,a){var s=e.helper.model.getData("u/separators");s[t.id].some(function(e,a){if(e.index===t.index)return s[t.id].splice(a,1),!0}),e.helper.model.setData({"u/separators":s},function(){"function"==typeof a&&a()})}},window.ext=function(t){var a=this,s={};this.firstRun=!0,this.refreshRun=!0,this.elements={},this.opts=t,this.run=function(){r(),a.helper.model.init(function(){a.helper.i18n.init(function(){a.helper.font.init(),a.helper.stylesheet.init(),o(),a.helper.list.init(),a.helper.toggle.init(),a.helper.sidebarEvents.init(),a.helper.dragndrop.init(),""===document.referrer&&a.helper.model.call("addViewAmount",{url:location.href})})})},this.isWindowed=function(){return 0!==window.screenX||0!==window.screenY||window.screen.availWidth!==window.innerWidth},this.refresh=function(){a.helper.model.init(function(){a.helper.i18n.init(function(){var e=a.helper.model.getData(["u/entriesLocked","u/showHidden"]);!1===e.entriesLocked?a.elements.sidebar.addClass(t.classes.sidebar.entriesUnlocked):a.elements.sidebar.removeClass(t.classes.sidebar.entriesUnlocked),!0===e.showHidden?a.elements.sidebar.addClass(t.classes.sidebar.showHidden):a.elements.sidebar.removeClass(t.classes.sidebar.showHidden),a.helper.list.updateBookmarkBox()})})},this.trackInitialEvents=function(){if(!a.elements.sidebar.hasClass(a.opts.classes.sidebar.openedOnce)){a.helper.model.call("trackEvent",{category:"directory",action:"openState_initial",label:"open",value:a.elements.bookmarkBox.all.find("a."+a.opts.classes.sidebar.dirOpened).length()});var e=a.helper.list.getSort();a.helper.model.call("trackEvent",{category:"sorting",action:"initial",label:e.name+"_"+e.dir});var t=a.elements.header.find("div."+a.opts.classes.sidebar.searchBox+" > input[type='text']")[0].value;t.length>0&&a.helper.model.call("trackEvent",{category:"search",action:"search",label:"initial",value:t.length})}},this.loaded=function(){if(!a.elements.iframeBody.hasClass(t.classes.sidebar.extLoaded)){var e=a.helper.model.getData(["b/pxTolerance","a/showIndicator"]);a.elements.iframeBody.addClass(t.classes.sidebar.extLoaded),document.dispatchEvent(new CustomEvent(t.events.loaded,{detail:{pxTolerance:e.pxTolerance,showIndicator:e.showIndicator},bubbles:!0,cancelable:!1}))}},this.startLoading=function(){a.elements.sidebar.addClass(t.classes.sidebar.loading),s.timeout&&clearTimeout(s.timeout),void 0!==s.loader&&0!==s.loader.length()||(s.loader=a.helper.template.loading().appendTo(a.elements.sidebar))},this.endLoading=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;s.timeout=setTimeout(function(){a.elements.sidebar.removeClass(t.classes.sidebar.loading),s.loader&&s.loader.remove(),s={}},e)},this.copyToClipboard=function(t){var s=e("<textarea />").text(t).appendTo(a.elements.iframeBody);s[0].select();var r=!1;try{r=a.elements.iframe[0].contentDocument.execCommand("copy")}catch(e){}return s.remove(),r},this.initImages=function(){a.elements.iframe.hasClass(a.opts.classes.page.visible)&&a.elements.sidebar.find("img["+t.attr.src+"]").forEach(function(a){var s=e(a),r=s.attr(t.attr.src);s.removeAttr(t.attr.src),s.attr("src",r)})},this.addShareUserdataMask=function(){a.elements.sidebar.find("#"+t.ids.sidebar.shareUserdata).remove();var s=e("<div />").attr("id",t.ids.sidebar.shareUserdata).prependTo(a.elements.sidebar),r=e("<div />").prependTo(s);e("<h2 />").html(a.helper.i18n.get("share_userdata_headline")).appendTo(r),e("<p />").html(a.helper.i18n.get("share_userdata_desc")).appendTo(r),e("<p />").html(a.helper.i18n.get("share_userdata_desc2")).appendTo(r),e("<p />").addClass(t.classes.sidebar.shareUserdataNotice).html(a.helper.i18n.get("share_userdata_notice")).appendTo(r),e("<a />").data("accept",!0).html(a.helper.i18n.get("share_userdata_accept")).appendTo(r),e("<a />").data("accept",!1).html(a.helper.i18n.get("share_userdata_decline")).appendTo(r)};var r=function(){a.helper={model:new window.ModelHelper(a),toggle:new window.ToggleHelper(a),entry:new window.EntryHelper(a),list:new window.ListHelper(a),scroll:new window.ScrollHelper(a),template:new window.TemplateHelper(a),i18n:new window.I18nHelper(a),font:new window.FontHelper(a),sidebarEvents:new window.SidebarEventsHelper(a),search:new window.SearchHelper(a),stylesheet:new window.StylesheetHelper(a),dragndrop:new window.DragDropHelper(a),checkbox:new window.CheckboxHelper(a),overlay:new window.OverlayHelper(a),utility:new window.UtilityHelper(a),contextmenu:new window.ContextmenuHelper(a)}},o=function(){a.helper.stylesheet.addStylesheets(["content"]),a.elements.iframe=e('<iframe id="'+t.ids.page.iframe+'" />').appendTo("body"),a.elements.iframeBody=a.elements.iframe.find("body"),a.elements.sidebar=e('<section id="'+t.ids.sidebar.sidebar+'" />').appendTo(a.elements.iframeBody),a.elements.bookmarkBox={},["all","search"].forEach(function(s){a.elements.bookmarkBox[s]=a.helper.scroll.add(t.ids.sidebar.bookmarkBox[s],e("<ul />").appendTo(a.elements.sidebar))}),a.elements.filterBox=e("<div />").addClass(t.classes.sidebar.filterBox).appendTo(a.elements.sidebar),a.elements.iframeBody.attr(t.attr.dragCancel,a.helper.i18n.get("sidebar_drag_cancel")),a.elements.header=e("<header />").prependTo(a.elements.sidebar),a.helper.stylesheet.addStylesheets(["sidebar"],a.elements.iframe);var s=a.helper.model.getData(["u/entriesLocked","u/showHidden","a/darkMode"]);!1===s.entriesLocked&&a.elements.sidebar.addClass(t.classes.sidebar.entriesUnlocked),!0===s.showHidden&&a.elements.sidebar.addClass(t.classes.sidebar.showHidden),!0===s.darkMode&&a.elements.iframeBody.addClass(t.classes.page.darkMode)}};var t={ids:{page:{iframe:"blockbyte-bs-sidebar",overlay:"blockbyte-bs-overlay",indicator:"blockbyte-bs-indicator"},sidebar:{sidebar:"sidebar",shareUserdata:"shareUserdata",bookmarkBox:{all:"bookmarkBox",search:"bookmarkBoxSearch"}},overlay:{urlList:"urlList"}},classes:{page:{indicatorIcon:"blockbyte-bs-icon",visible:"blockbyte-bs-visible",isNewTab:"blockbyte-bs-isNewTab",hover:"blockbyte-bs-hover",noscroll:"blockbyte-bs-noscroll",hasLeftsideBack:"blockbyte-bs-has-lsb",darkMode:"dark",ee:"ee"},sidebar:{extLoaded:"loaded",openedOnce:"openedOnce",active:"active",mark:"mark",hideRoot:"hideRoot",entriesUnlocked:"entriesUnlocked",showHidden:"showHidden",dirAnimated:"animated",dirOpened:"opened",bookmarkDir:"dir",dirIcon:"icon",separator:"separator",bookmarkLink:"link",bookmarkLabel:"label",menu:"menu",sort:"sort",hidden:"hidden",hover:"hover",loading:"loading",copied:"copied",filterBox:"filter",search:"search",searchBox:"searchBox",searchClose:"searchClose",searchVisible:"searchVisible",shareUserdataNotice:"shareNotice"},contextmenu:{wrapper:"contextmenu",top:"top",visible:"visible",list:"list",icons:"icons",right:"right",separator:"separator"},drag:{trigger:"drag",helper:"dragHelper",isDragged:"isDragged",cancel:"dragCancel",dragHover:"dragHover",snap:"snap",dragInitial:"dragInitial"},scrollBox:{wrapper:"scrollBox",scrollbar:"scrollbar",inactive:"inactive",hideScrollbar:"hideScrollbar",hidden:"hidden",scrolled:"scrolled"},checkbox:{box:"checkbox",active:"active",clicked:"clicked",focus:"focus"},overlay:{modal:"modal",visible:"visible",preview:"preview",previewUrl:"previewUrl",action:"action",close:"close",hasTooltip:"tooltip",inputError:"error",success:"success",progressBar:"progressBar",buttonWrapper:"buttons",checkUrlProgressLabel:"progressLabel",urlCheckLoading:"urlCheckLoading",urlCheckList:"urlCheckList"}},attr:{src:"data-src",position:"data-pos",type:"data-type",name:"data-name",value:"data-value",sort:"data-sort",direction:"data-direction",dragCancel:"data-dragCancel",id:"data-id"},events:{loaded:"blockbyte-bs-loaded",checkboxChanged:"blockbyte-bs-checkboxChanged",scrollBoxLastPart:"blockbyte-bs-scrollBoxLastPart",lsbLoaded:"blockbyte-lsb-loaded"},leftsideBackSelector:"div#blockbyte-lsb-indicator.blockbyte-lsb-visible",manifest:chrome.runtime.getManifest(),demoMode:!1};new window.ext(t).run()}(jsu);