/*! Bookmark Sidebar v1.3.6 | (c) Philipp KÃ¶nig under GPL-3.0 */
"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a="isDefined",b="forEach",c=function(){return function(){function c(){_classCallCheck(this,c)}return _createClass(c,null,[{key:a,value:function(a){return"undefined"!=typeof a&&null!==a}},{key:b,value:function(c,d){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f=c.length;if(e){for(var g=f-1;g>=0;g--)if(this[a](c[g][b]))this[b](c[g],d,e);else if(d(c[g],g)===!1)break}else for(var h=0;h<f;h++)if(this[a](c[h][b]))this[b](c[h],d,e);else if(d(c[h],h)===!1)break}}]),c}()}(),d=function(c){var e=document,f=new WeakMap,g=new WeakMap,h=Symbol(),i="_fillNodeList",j="document",k="eq",l="get",m="length",n="remove",o="_addEventListener",p="_cloneEventListener",q="_addData",r="_cloneData",s="_cloneElement",t="clone",u="on",v="off",w="trigger",x="find",y="children",z="_htmlText",A="html",B="text",C="data",D="removeData",E="css",F="attr",G="removeAttr",H="addClass",I="removeClass",J="toggleClass",K="hasClass",L="_moveElement",M="_moveElementTo",N="append",O="prepend",P="appendTo",Q="prependTo",R="after",S="before",T="insertAfter",U="insertBefore",V="_nextPrev",W="next",X="prev",Y="_siblings",Z="siblings",$="nextAll",_="prevAll",aa="parent",ba="parents",ca="_realDimension",da="realWidth",ea="realHeight";return function(){function fa(a){var b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_classCallCheck(this,fa);var c=a;if("string"==typeof a&&(b===!1||a.search("<")>-1)){var d=e.createElement("div");d.innerHTML=a,c=d.childNodes}this[i](c)}return _createClass(fa,[{key:i,value:function(f){var g=this;if(c[a](f))if(f instanceof d)this[h]=f[l]();else if("string"==typeof f)this[h]=e.querySelectorAll(f);else if(f instanceof Node||f instanceof HTMLDocument||f instanceof Window)this[h]=[f];else if(f instanceof NodeList||f instanceof HTMLCollection)this[h]=f;else{if("object"!==("undefined"==typeof f?"undefined":_typeof(f)))throw new DOMException("invalid parameter for jsu");this[h]=[],c[a](f[b])||(f=[f]),f[b](function(a){var e=function(a){g[h].indexOf(a)===-1&&g[h].push(a)};a instanceof d?a[b](e):a instanceof NodeList||a instanceof HTMLCollection?c[b](a,e):g[h].push(a)})}else this[h]=[];this[b](function(a,b){g[b]=a})}},{key:b,value:function(a){var d=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return c[b](this[h],a,d),this}},{key:E,value:function(d,e){var f=!0,g=c[a](d),i=c[a](e),j=[];return this[b](function(a){g&&i&&"string"==typeof d?a.style[d]=e:g&&("string"==typeof d?(j.push(window.getComputedStyle(a)[d]),f=!1):"object"===("undefined"==typeof d?"undefined":_typeof(d))&&Object.keys(d)[b](function(b){"string"==typeof b&&(a.style[b]=d[b])}))}),f?this:this[h].length>1?j:j[0]}},{key:F,value:function(d,e){var f=!0,g=c[a](d),i=c[a](e),j=[];return this[b](function(h){var k=function(b,d){c[a](h[b])?h[b]=d:h.setAttribute(b,d)},l=function(b){return c[a](h[b])?h[b]:h.getAttribute(b)};g&&i&&"string"==typeof d?k(d,e):g&&("string"==typeof d?(j.push(l(d)),f=!1):"object"===("undefined"==typeof d?"undefined":_typeof(d))&&Object.keys(d)[b](function(a){"string"==typeof a&&k(a,d[a])}))}),f?this:this[h].length>1?j:j[0]}},{key:G,value:function(a){return this[b](function(b){b.removeAttribute(a)}),this}},{key:t,value:function(){return d[s](this)}},{key:C,value:function(e,f){var i=!0,j=c[a](e),k=c[a](f),l=[];return this[b](function(h){var m=g.get(h),n=c[a](m);j&&k?d[q](h,e,f):j?"string"==typeof e?(l.push(n?m[e]:void 0),i=!1):"object"===("undefined"==typeof e?"undefined":_typeof(e))&&Object.keys(e)[b](function(a){"string"==typeof a&&d[q](h,a,e[a])}):(l.push(n?m:{}),i=!1)}),i?this:this[h].length>1?l:l[0]}},{key:D,value:function(d){var e=!c[a](d);return this[b](function(b){var f=g.get(b);c[a](f)&&(e?g.delete(b):c[a](f[d])&&delete f[d])}),this}},{key:u,value:function(a,e,f,g,h){var i=function(a,c){Object.keys(c)[b](function(b){try{Object.defineProperty(a,b,{value:c[b]})}catch(a){}})},j=f;"function"==typeof f?j=g:h=g,"undefined"==typeof j&&(j=null),"undefined"==typeof h&&(h=null);var k="string"==typeof e;return this[b](function(g){var l=a.split(/\s+/g);l[b](function(a){var l=function(d){i(d,{type:a}),k?c[b](g.querySelectorAll(":scope "+e),function(b){for(var c=d.target;c&&c!==g;){if(c===b){var e=new MouseEvent(a,d);i(e,{preventDefault:function(){d.preventDefault()},stopPropagation:function(){d.stopPropagation()},target:d.target,currentTarget:c}),f(e)}c=c.parentNode}}):"function"==typeof e&&e(d)};d[o](g,{event:a,fn:l,opts:j,wantsUntrusted:h})})},!0),this}},{key:v,value:function(d){return this[b](function(e){var g=f.get(e);if(c[a](g)){var h=d.split(/\s+/g);h[b](function(a){g[a]&&c[b](g[a],function(b,c){e.removeEventListener(a,b.fn),g[a].splice(c,1)},!0)})}}),this}},{key:w,value:function(a,c){var d=this,e=a.split(/\s+/g);return e[b](function(a){var e=new Event(a,c);d[b](function(a){a.dispatchEvent(e)})}),this}},{key:H,value:function(a){return this[b](function(b){b.classList.add(a)}),this}},{key:I,value:function(a){return this[b](function(b){b.classList.remove(a)}),this}},{key:J,value:function(a){return this[b](function(b){b.classList.toggle(a)}),this}},{key:K,value:function(a){var c=[];return this[b](function(b){c.push(b.classList.contains(a))}),this[h].length>1?c:c[0]}},{key:ca,value:function(a){var c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d=[],e="width",f=["left","right"];return"h"===a&&(e="height",f=["top","bottom"]),this[b](function(a){var b=a.getBoundingClientRect(),g=window.getComputedStyle(a),h=b[e];c&&(h+=parseInt(g.getPropertyValue("margin-"+f[0])),h+=parseInt(g.getPropertyValue("margin-"+f[1]))),d.push(h)}),this[h].length>1?d:d[0]}},{key:da,value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this[ca]("w",a)}},{key:ea,value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this[ca]("h",a)}},{key:x,value:function(a){var c=[];return this[b](function(b){b instanceof HTMLIFrameElement?c.push(b.contentDocument.querySelectorAll(":scope "+a)):c.push(b.querySelectorAll(":scope "+a))}),new d(c)}},{key:y,value:function(a){var c=[];return this[b](function(b){c.push(b.querySelectorAll(":scope > "+a))}),new d(c)}},{key:z,value:function(d,e){var f=c[a](d),g=f?this:"";return this[b](function(a){f?a[e]=d:g+=a[e]}),g}},{key:A,value:function(a){return this[z](a,"innerHTML")}},{key:B,value:function(a){return this[z](a,"innerText")}},{key:n,value:function(){this[b](function(a){a&&a.parentElement&&(f.delete(a),g.delete(a),a.parentElement.removeChild(a))})}},{key:L,value:function(a){var c=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=arguments[2];"string"==typeof a&&a.search("<")>-1&&(c=!1);var f=new d(a,c);return this[b](function(a){var c=d[s](f);c[b](function(b){switch(e){case"append":a.appendChild(b);break;case"prepend":a.insertBefore(b,a.firstChild);break;case"before":a.parentNode.insertBefore(b,a);break;case"after":a.parentNode.insertBefore(b,a.nextSibling)}})}),f[n](),this}},{key:M,value:function(a,c){var e=this,f=[],g=new d(a);return g[b](function(a){var g=d[s](e);g[b](function(b){switch(c){case"append":a.appendChild(b);break;case"prepend":a.insertBefore(b,a.firstChild);break;case"before":a.parentNode.insertBefore(b,a);break;case"after":a.parentNode.insertBefore(b,a.nextSibling)}f.push(b)})}),this[n](),new d(f)}},{key:N,value:function(a,b){return this[L](a,b,"append")}},{key:P,value:function(a){return this[M](a,"append")}},{key:O,value:function(a){var b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this[L](a,b,"prepend")}},{key:Q,value:function(a){return this[M](a,"prepend")}},{key:S,value:function(a){var b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this[L](a,b,"before")}},{key:U,value:function(a){return this[M](a,"before")}},{key:R,value:function(a){var b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this[L](a,b,"after")}},{key:T,value:function(a){return this[M](a,"after")}},{key:V,value:function(e,f){var g=c[a](e),h=[];return this[b](function(b){var d="prev"===f?b.previousElementSibling:b.nextElementSibling;c[a](d)&&(!g||c[a](d.matches)&&d.matches(e))&&h.push(d)}),new d(h)}},{key:W,value:function(a){return this[V](a,"next")}},{key:X,value:function(a){return this[V](a,"prev")}},{key:Y,value:function(e){var f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"siblings",g=c[a](e),i=[];return this[b](function(a){var b=null,c=[];for("siblings"===f&&a.parentNode.firstElementChild?(b=a.parentNode.firstElementChild,f="next"):"previous"!==f&&"next"!==f||(b=a[f+"ElementSibling"]);b&&b.matches;)b===a||g&&!b.matches(e)||c.push(b),b=b[f+"ElementSibling"];i.push(new d(c))}),this[h].length>1?i:i[0]}},{key:Z,value:function(a){return this[Y](a)}},{key:$,value:function(a){return this[Y](a,"next")}},{key:_,value:function(a){return this[Y](a,"previous")}},{key:aa,value:function(e){var f=c[a](e),g=[];return this[b](function(b){var h=b.parentNode;!f||c[a](h.matches)&&h.matches(e)||(h=null),g.push(new d(h))}),this[h].length>1?g:g[0]}},{key:ba,value:function(e){var f=this,g=c[a](e),i=[];return this[b](function(a){for(var b=[],c=a.parentNode;c&&c.matches&&c!==f;)g&&!c.matches(e)||b.push(c),c=c.parentNode;i.push(new d(b))}),this[h].length>1?i:i[0]}},{key:j,value:function(){var a=[];return this[b](function(b){a.push(new d(b.ownerDocument))}),this[h].length>1?a:a[0]}},{key:k,value:function(a){return a<0&&(a=this[h].length+a),new d(this[h][a])}},{key:l,value:function(b){return c[a](b)?(b<0&&(b=this[h].length+b),this[h][b]):this[h]}},{key:m,value:function(){return this[h].length}}],[{key:o,value:function(b,d){var e=f.get(b);c[a](e)||(e={},f.set(b,e)),e[d.event]||(e[d.event]=[]),e[d.event].push({fn:d.fn,opts:d.opts,wantsUntrusted:d.wantsUntrusted}),b.addEventListener(d.event,d.fn,d.opts,d.wantsUntrusted)}},{key:p,value:function(e,g){var h=f.get(e);c[a](h)&&Object.keys(h)[b](function(a){h[a][b](function(b){d[o](g,{event:a,fn:b.fn,opts:b.opts,wantsUntrusted:b.wantsUntrusted})})}),g.children&&c[b](g.children,function(a,b){d[p](e.children[b],a)})}},{key:q,value:function(b,d,e){var f=g.get(b);c[a](f)||(f={},g.set(b,f)),f[d]=e}},{key:r,value:function(e,f){var h=g.get(e);c[a](h)&&Object.keys(h)[b](function(a){d[q](f,a,h[a])}),f.children&&c[b](f.children,function(a,b){d[r](e.children[b],a)})}},{key:s,value:function(a){var c=[];return a[b](function(a){var b=a.cloneNode(!0);d[p](a,b),d[r](a,b),c.push(b)}),new d(c)}}]),fa}()}(c);window.jsu=function(a){return new d(a)}}(),function(a){window.CheckboxHelper=function(b){var c=null;this.get=function(c,e){var f=a("<div />").data("contextBody",c).html("<input type='checkbox' />").addClass(b.opts.classes.checkbox.box);return"undefined"!=typeof e&&f.children("input[type='checkbox']").attr(e),f.children("input[type='checkbox']")[0].checked&&f.addClass(b.opts.classes.checkbox.active),d(f),f};var d=function(d){d.on("mousedown",function(c){c.preventDefault(),c.stopPropagation(),a(c.currentTarget).addClass(b.opts.classes.checkbox.focus)}).on("click",function(d){d.preventDefault(),d.stopPropagation();var e=a(d.currentTarget);e.addClass(b.opts.classes.checkbox.clicked),e.removeClass(b.opts.classes.checkbox.focus),e.toggleClass(b.opts.classes.checkbox.active);var f=e.hasClass(b.opts.classes.checkbox.active);e.children("input[type='checkbox']").attr("checked",f),c&&clearTimeout(c),c=setTimeout(function(){e.removeClass(b.opts.classes.checkbox.clicked)},300)}),d.data("contextBody").on("click",function(a){d.removeClass(b.opts.classes.checkbox.focus)})}}}(jsu),function(a){window.ContextmenuHelper=function(b){this.close=function(){var c=b.elements.iframeBody.find("div."+b.opts.classes.contextmenu.wrapper);c.forEach(function(c){a(c).removeClass(b.opts.classes.contextmenu.visible),a(c).data("elm").removeClass(b.opts.classes.sidebar.active)}),setTimeout(function(){c.remove()},500)},this.create=function(f,g){g.addClass(b.opts.classes.sidebar.active);var h=a("<div />").addClass(b.opts.classes.contextmenu.wrapper).html("<ul />").attr("data-type",f).data("elm",g).appendTo(b.elements.sidebar);switch(f){case"list":d(h,g);break;case"settings":c(h,g)}e(h),setTimeout(function(){h.addClass(b.opts.classes.contextmenu.visible);var a=parseInt(h.css("top")),c=h.realHeight();a+c>=window.innerHeight&&h.css("top",a-c).addClass(b.opts.classes.contextmenu.top)},0)};var c=function(a,b){a.children("ul").append("<li><a data-type='settings'><span></span>"+chrome.i18n.getMessage("contextmenu_settings")+"</a></li>").append("<li><a data-type='bookmarkManager'><span></span>"+chrome.i18n.getMessage("contextmenu_bookmark_manager")+"</a></li>").append("<li><a data-type='updateUrls'><span></span>"+chrome.i18n.getMessage("contextmenu_update_urls")+"</a></li>").append("<li><a data-type='toggleFix'><span></span>"+chrome.i18n.getMessage("contextmenu_toggle_fix")+"</a></li>");var c=b[0].getBoundingClientRect();a.css("top",c.top+c.height+"px")},d=function(a,c){var d=c.data("infos"),e=c[0].getBoundingClientRect(),f=b.elements.sidebar.realWidth()-e.left,g=window.getComputedStyle(a[0]);f-=parseInt(g.getPropertyValue("margin-left")),f-=parseInt(g.getPropertyValue("margin-right")),a.css({width:f+"px",top:e.top+c.realHeight()+"px",left:e.left+"px"}),b.helper.model.getConfig("newTab",function(b){a.data("newTabForeground","foreground"===b)},function(b){a.data("newTabForeground","foreground"===b)});var h=d.children?"_dir":"_bookmark";a.children("ul").append("<li><a data-type='infos'><span></span>"+chrome.i18n.getMessage("contextmenu_infos")+"</a></li>").append("<li><a data-type='edit'><span></span>"+chrome.i18n.getMessage("contextmenu_edit"+h)+"</a></li>").append("<li><a data-type='delete'><span></span>"+chrome.i18n.getMessage("contextmenu_delete"+h)+"</a></li>"),d.children||a.children("ul").prepend("<li><a data-type='newTab'><span></span>"+chrome.i18n.getMessage("contextmenu_new_tab")+"</a></li>")},e=function(c){c.find("a").on("click",function(d){d.preventDefault();var e=a(d.currentTarget).attr("data-type");switch(e){case"settings":b.helper.model.call("openLink",{href:"chrome://extensions/?options="+chrome.runtime.id,newTab:!0});break;case"toggleFix":b.elements.iframeBody.toggleClass(b.opts.classes.sidebar.entriesUnlocked),b.helper.model.setConfig({entriesLocked:b.elements.iframeBody.hasClass(b.opts.classes.sidebar.entriesUnlocked)?"n":"y"});break;case"bookmarkManager":b.helper.model.call("openLink",{href:"chrome://bookmarks",newTab:!0});break;case"newTab":var f=c.data("elm").data("infos");b.helper.model.call("openLink",{parentId:f.parentId,id:f.id,href:f.url,newTab:!0,active:c.data("newTabForeground")});break;default:var g=c.data("elm").data("infos");b.helper.overlay.create(e,a(d.currentTarget).text(),g)}})}}}(jsu),function(a){window.DragDropHelper=function(b){var c=null;this.init=function(){b.helper.model.getConfig("scrollSensitivity",function(a){c=JSON.parse(a)},function(a){c=JSON.parse(a)}),e()};var d=function(a){var c=a[0].getBoundingClientRect();return.6*a.realWidth()+c.left>b.elements.sidebar.realWidth()},e=function(){b.elements.bookmarkBox.children("ul").on("mousedown","span."+b.opts.classes.drag.trigger,function(c){b.helper.contextmenu.close();var d=a(c.currentTarget).parent("a").removeClass(b.opts.classes.sidebar.dirOpened),e=d.parent("li");b.elements.iframeBody.addClass(b.opts.classes.drag.isDragged),e.clone().addClass(b.opts.classes.drag.dragInitial).insertAfter(e);var f=d.clone().appendTo(b.elements.iframeBody),g=d[0].getBoundingClientRect();f.removeAttr("title").css({top:g.top+"px",left:g.left+"px",width:d.realWidth()+"px"}).data({elm:e,isDir:!!d.data("infos").children,startPos:{top:c.pageY-g.top,left:c.pageX-g.left}}).addClass(b.opts.classes.drag.helper),e.addClass(b.opts.classes.drag.isDragged)}),b.elements.iframeBody.on("mouseup",function(a){b.elements.iframeBody.hasClass(b.opts.classes.drag.isDragged)&&!function(){a.preventDefault(),a.stopPropagation();var c=b.elements.iframeBody.children("a."+b.opts.classes.drag.helper),e=b.elements.iframeBody.find("li."+b.opts.classes.drag.dragInitial),f=c.data("elm");if(d(c))f.insertAfter(e).removeClass(b.opts.classes.drag.isDragged),e.remove(),c.remove();else{c.addClass(b.opts.classes.drag.snap);var g=f.children("a").data("infos"),h=f.parent("ul").prev("a").data("infos"),i=f.prevAll("li").length();f.prevAll("li."+b.opts.classes.drag.dragInitial).length()>0&&i--,b.helper.model.call("moveBookmark",{id:g.id,parentId:h.id,index:i}),setTimeout(function(){var a=f[0].getBoundingClientRect();c.css({top:a.top+"px",left:a.left+"px"}),setTimeout(function(){f.removeClass(b.opts.classes.drag.isDragged),e.remove(),c.remove()},200)},0)}b.elements.iframeBody.removeClass(b.opts.classes.drag.isDragged)}()}),b.elements.iframeBody.on("wheel","a."+b.opts.classes.drag.helper,function(a){a.preventDefault(),a.stopPropagation();var d=b.elements.bookmarkBox.data("scrollpos")||0,e=Math.abs(a.wheelDelta)<60?"trackpad":"mouse";b.elements.bookmarkBox.data("scrollpos",d-a.wheelDelta*c[e]),b.helper.scroll.update(b.elements.bookmarkBox)}),b.elements.iframe.find("body").on("mousemove",function(c){b.elements.iframeBody.hasClass(b.opts.classes.drag.isDragged)&&1===c.which&&!function(){c.preventDefault(),c.stopPropagation();var e=b.elements.iframeBody.children("a."+b.opts.classes.drag.helper),f=e.data("startPos"),g=c.pageY-f.top,h=c.pageX-f.left;e.css({top:g+"px",left:h+"px"}),d(e)?b.elements.iframeBody.addClass(b.opts.classes.drag.cancel):b.elements.iframeBody.removeClass(b.opts.classes.drag.cancel);var i=null,j=e.data("elm");if(a([b.elements.bookmarkBox.find("> ul > li > a."+b.opts.classes.sidebar.dirOpened).parent("li"),b.elements.bookmarkBox.find("a."+b.opts.classes.sidebar.dirOpened+" + ul > li")]).forEach(function(c){var d=a(c);if(c!==j[0]&&!d.hasClass(b.opts.classes.drag.dragInitial)){var e=c.getBoundingClientRect();if(e.top>g)return!1;i=d}}),i){var k=i.children("a").eq(0);k.hasClass(b.opts.classes.sidebar.bookmarkDir)?k.hasClass(b.opts.classes.sidebar.dirOpened)?e.data("elm",j.prependTo(k.next("ul"))):e.data("isDir")?e.data("elm",j.insertAfter(i)):k.hasClass(b.opts.classes.sidebar.dirAnimated)||b.helper.sidebarEvents.toggleBookmarkDir(k):e.data("elm",j.insertAfter(i))}}()}),b.elements.iframeBody.on("contextmenu","a."+b.opts.classes.drag.helper,function(a){a.preventDefault(),a.stopPropagation()})}}}(jsu),function(a){window.ModelHelper=function(a){var b={addVisual:"y",rememberScroll:"y",hideEmptyDirs:"y",openAction:"contextmenu",pxTolerance:'{"windowed":20,"maximized":1}',scrollPos:"{}",openStates:"{}",closeTimeout:1,middleClickActive:"y",newTab:"foreground",scrollSensitivity:'{"mouse":1,"trackpad":1}',entriesLocked:"y"};this.call=function(a,b,c){b.type=a,chrome.extension.sendMessage(b,function(a){"function"==typeof c&&c(a)})},this.setConfig=function(a,b){chrome.storage.sync.set(a,function(a){"function"==typeof b&&b(a)})},this.getConfig=function(a,c,d){var e=a;"string"==typeof e&&(e=[e]),e.indexOf("newTab")>-1&&e.push("middleClickActive");var f={};e.forEach(function(a){f[a]=b[a]}),"string"==typeof a&&(f=f[a]),"function"==typeof d&&d(f),chrome.storage.sync.get(e,function(d){var f={};e.forEach(function(a){"undefined"==typeof d[a]&&(d[a]=void 0)}),Object.keys(d).forEach(function(a){var c=d[a];"pxTolerance"===a&&"string"==typeof c&&0===c.search(/^\d+$/)&&(c='{"windowed":20,"maximized":'+c+"}"),"undefined"==typeof c&&(c="undefined"!=typeof d.middleClickActive?"y"===d.middleClickActive?"foreground":"background":b[a]),f[a]=c}),"string"==typeof a&&(f=f[a]),"function"==typeof c&&c(f)})}}}(jsu),function(a){window.OverlayHelper=function(b){var c={};this.create=function(d,g,h){var j=!!h.children;switch(c.overlay=a("<iframe />").attr("id",b.opts.ids.page.overlay).appendTo("body"),c.overlay.find("head").append("<link rel='stylesheet' type='text/css' href='"+b.opts.fontHref+"' />"),c.overlay.find("head").append("<link rel='stylesheet' type='text/css' href='"+chrome.extension.getURL("css/overlay.css")+"' />"),c.modal=a("<div />").attr("data-type",d).data("infos",h).addClass(b.opts.classes.overlay.modal).appendTo(c.overlay.find("body")),c.modal.append("<h1>"+g+"</h1>"),a("<a />").addClass(b.opts.classes.overlay.close).appendTo(c.modal),c.buttonWrapper=a("<menu />").appendTo(c.modal),a("<a />").addClass(b.opts.classes.overlay.close).text(chrome.i18n.getMessage("overlay_"+("infos"===d?"close":"cancel"))).appendTo(c.buttonWrapper),d){case"delete":e(h,j);break;case"edit":f(h,j);break;case"infos":i(h,j);break;case"updateUrls":k(h,j)}o(),setTimeout(function(){c.modal.addClass(b.opts.classes.overlay.visible),c.overlay.addClass(b.opts.classes.page.visible)},100)};var d=function(d,e,f){var g=a("<"+(e?"span":"a")+" />").attr("title",d.title+"\n"+d.url).data("infos",d).addClass(b.opts.classes.overlay.preview).html("<img src='"+d.icon+"' />"+d.title).appendTo(c.modal);f&&f===!0&&e===!1&&a("<a />").addClass(b.opts.classes.overlay.previewUrl).attr("title",d.url).data("infos",d).text(d.url).insertAfter(g)},e=function(e,f){a("<p />").text(chrome.i18n.getMessage("overlay_delete_"+(f?"dir":"bookmark")+"_confirm")).appendTo(c.modal),d(e,f),a("<a />").addClass(b.opts.classes.overlay.action).text(chrome.i18n.getMessage("overlay_delete")).appendTo(c.buttonWrapper)},f=function(e,f){d(e,f);var g=a("<ul />").appendTo(c.modal);g.append("<li><label>"+chrome.i18n.getMessage("overlay_bookmark_title")+"</label><input type='text' name='title' value='"+e.title+"' /></li>"),f||g.append("<li><label>"+chrome.i18n.getMessage("overlay_bookmark_url")+"</label><input type='text' name='url' value='"+e.url+"' /></li>"),a("<a />").addClass(b.opts.classes.overlay.action).text(chrome.i18n.getMessage("overlay_save")).appendTo(c.buttonWrapper)},g=function(a){return a.toLocaleDateString([chrome.i18n.getUILanguage(),b.opts.manifest.default_locale],{year:"numeric",month:"2-digit",day:"2-digit"})},h=function(c,d,e){var f=0;"undefined"!=typeof e.views?f=e.views:"undefined"!=typeof e.clickAmount&&(f=e.clickAmount);var h=new Date(Math.max(d.dateAdded,e.counterStartDate)),i=Math.max(1,Math.round((+new Date-h)/2627999942.4)),j=Math.round(f/i*100)/100,k=a("<li />").addClass(b.opts.classes.overlay.hasTooltip).append("<span>"+f+"</span>").append(" "+chrome.i18n.getMessage("overlay_bookmark_views"+(1===f?"_single":"")),!1).appendTo(c);a("<ul />").append("<li>"+chrome.i18n.getMessage("overlay_bookmark_views_since")+" "+g(h)+"</li>").append("<li>"+j+" "+chrome.i18n.getMessage("overlay_bookmark_views"+(1===j?"_single":""))+" "+chrome.i18n.getMessage("overlay_bookmark_views_per_month")+"</li>").appendTo(k)},i=function(e,f){d(e,f,!0);var i=a("<ul />").appendTo(c.modal),j=new Date(e.dateAdded);a("<li />").html(chrome.i18n.getMessage("overlay_bookmark_created_date")+" "+g(j)).appendTo(i),f?b.helper.model.call("dirInfos",{id:e.id},function(c){var d=a("<li />").addClass(b.opts.classes.overlay.hasTooltip).append("<span>"+c.childrenAmount.total+"</span>").append(" "+chrome.i18n.getMessage("overlay_dir_children"),!1).appendTo(i);a("<ul />").append("<li>"+c.childrenAmount.bookmarks+" "+chrome.i18n.getMessage("overlay_dir_children_bookmarks")+"</li>").append("<li>"+c.childrenAmount.dirs+" "+chrome.i18n.getMessage("overlay_dir_children_dirs")+"</li>").appendTo(d),h(i,e,c)}):b.helper.model.call("viewAmount",{id:e.id},function(a){h(i,e,a)})},j=function(d){setTimeout(function(){c.desc.remove(),c.progressBar.remove(),c.progressLabel.remove(),c.modal.addClass(b.opts.classes.overlay.urlCheckFinished),setTimeout(function(){c.loader.remove(),a("<a />").addClass(b.opts.classes.overlay.action).text(chrome.i18n.getMessage("overlay_update")).appendTo(c.buttonWrapper),c.modal.removeClass(b.opts.classes.overlay.urlCheckLoading);var e=b.helper.scroll.add(b.opts.ids.overlay.urlList,a("<ul />").appendTo(c.modal));d.forEach(function(d){var f=a("<li />").data("infos",d).append(b.helper.checkbox.get(c.overlay.find("body"),{checked:"checked"})).append("<strong>"+d.title+"</strong>");a("<a />").attr({href:d.url,title:d.url,target:"_blank"}).text(d.url).appendTo(f),404===d.urlStatusCode?a("<span />").text(chrome.i18n.getMessage("overlay_check_urls_not_found")).appendTo(f):d.newUrl!==d.url&&a("<a />").attr({href:d.newUrl,title:d.newUrl,target:"_blank"}).text(d.newUrl).appendTo(f),f=f.appendTo(e.children("ul")),b.helper.model.call("favicon",{url:d.url},function(c){c.img&&a("<img src='"+c.img+"' />").insertAfter(f.children("div."+b.opts.classes.checkbox.box))})}),b.helper.scroll.update(e)},1e3)},1e3)},k=function(d,e){var f=d.bookmarks.length;c.desc=a("<p />").text(chrome.i18n.getMessage("overlay_check_urls_loading")).appendTo(c.modal),c.progressBar=a("<div />").addClass(b.opts.classes.overlay.progressBar).html("<div />").appendTo(c.modal),c.progressLabel=a("<span />").addClass(b.opts.classes.overlay.checkUrlProgressLabel).html("<span>0</span>/<span>"+f+"</span>").appendTo(c.modal),c.loader=b.getLoaderHtml().appendTo(c.modal),setTimeout(function(){c.modal.addClass(b.opts.classes.overlay.urlCheckLoading)},500);var g=0,h=[];d.bookmarks.forEach(function(a){return c.overlay.length()>0&&void b.helper.model.call("realUrl",{url:a.url},function(b){g++,c.progressBar.children("div").css("width",g/f*100+"%"),c.progressLabel.children("span").eq(0).text(g),(404===+b.code||a.url!==b.url&&302!==+b.code)&&(a.newUrl=b.url,a.urlStatusCode=+b.code,h.push(a)),g===f&&j(h)})})},l=function(a){b.elements.iframe.removeClass(b.opts.classes.page.visible),c.modal.find("a."+b.opts.classes.overlay.close).eq(0).trigger("click");var d=+new Date;b.helper.model.call("deleteBookmark",{id:a.id},function(){setTimeout(function(){b.update()},Math.min(300,+new Date-d))})},m=function(a){var d=!!a.children,e=c.modal.find("input[name='title']"),f=c.modal.find("input[name='url']"),g=e[0].value.trim(),h=d?null:f[0].value.trim();0===g.length?e.addClass(b.opts.classes.overlay.inputError):d||0!==h.length?!function(){b.elements.iframe.removeClass(b.opts.classes.page.visible),c.modal.find("a."+b.opts.classes.overlay.close).eq(0).trigger("click");var d=+new Date;b.helper.model.call("updateBookmark",{id:a.id,title:g,url:h},function(){setTimeout(function(){b.update()},Math.min(300,+new Date-d))})}():f.addClass(b.opts.classes.overlay.inputError)},n=function(){c.modal.find("div#"+b.opts.ids.overlay.urlList+" ul > li").forEach(function(c){if(a(c).find("input[type='checkbox']")[0].checked){var d=a(c).data("infos");404===d.urlStatusCode?b.helper.model.call("deleteBookmark",{id:d.id}):d.url!==d.newUrl&&b.helper.model.call("updateBookmark",{id:d.id,title:d.title,url:d.newUrl})}}),b.elements.iframe.removeClass(b.opts.classes.page.visible),c.modal.find("a."+b.opts.classes.overlay.close).eq(0).trigger("click"),setTimeout(function(){b.update()},300)},o=function(){c.overlay.find("body").on("click",function(c){"BODY"===c.target.tagName&&a(c.target).find("a."+b.opts.classes.overlay.close).eq(0).trigger("click")}),c.overlay.find("body").on("wheel",function(c){a(c.target).hasClass(b.opts.classes.scrollBox.wrapper)||0!==a(c.target).parents("."+b.opts.classes.scrollBox.wrapper).length()||(c.preventDefault(),c.stopPropagation())}),c.modal.find("a."+b.opts.classes.overlay.close).on("click",function(a){a.preventDefault(),b.helper.model.call("realUrl",{abort:!0}),c.overlay.removeClass(b.opts.classes.page.visible),setTimeout(function(){c.overlay.remove()},500)}),c.modal.on("click","a."+b.opts.classes.overlay.action,function(a){a.preventDefault();var b=c.modal.data("infos");switch(c.modal.attr("data-type")){case"delete":l(b);break;case"edit":m(b);break;case"updateUrls":n(b)}}),c.modal.on("focus","input",function(c){a(c.currentTarget).removeClass(b.opts.classes.overlay.inputError)}),c.modal.find("a."+b.opts.classes.overlay.preview+", a."+b.opts.classes.overlay.previewUrl).on("click",function(c){c.preventDefault();var d=a(c.currentTarget).data("infos");b.helper.model.call("openLink",{parentId:d.parentId,id:d.id,href:d.url,newTab:!0})})}}}(jsu),function(a){window.ScrollHelper=function(b){var c=+new Date,d={},e=null;this.add=function(c,d){var f=a("<div id='"+c+"' class='"+b.opts.classes.scrollBox.wrapper+"' />").insertBefore(d);d=d.appendTo(f);var i=a("<div class='"+b.opts.classes.scrollBox.scrollbar+"' />").html("<div />").appendTo(f);return f.data({content:d,scrollbar:i}),b.helper.model.getConfig("scrollSensitivity",function(a){e=JSON.parse(a)},function(a){e=JSON.parse(a)}),h(f),g(f,0),f},this.update=function(a,b){var c=a.data("scrollpos")||0;g(a,c),b&&f(a)},this.restoreScrollPos=function(a,c){b.helper.model.getConfig(["rememberScroll","scrollPos"],function(b){if("y"===b.rememberScroll){var d=JSON.parse(b.scrollPos);g(a,d[a.attr("id")]||0),setTimeout(function(){"function"==typeof c&&c()},100)}else"function"==typeof c&&c()})};var f=function(a){b.firstRun===!1&&+new Date-c>500&&b.helper.model.getConfig("scrollPos",function(d){c=+new Date;var e=JSON.parse(d);e[a.attr("id")]=a.data("scrollpos")||0,b.helper.model.setConfig({scrollPos:JSON.stringify(e)})})},g=function(a,c){b.helper.contextmenu.close();var e=a.realHeight(),f=a.data("content").realHeight(!0);c=Math.max(0,c),e>=f?(a.data("scrollbar").addClass(b.opts.classes.scrollBox.inactive),c=0):(a.data("scrollbar").removeClass(b.opts.classes.scrollBox.inactive),c>=f-e?(c=f-e,a.addClass(b.opts.classes.scrollBox.scrolledEnd)):a.removeClass(b.opts.classes.scrollBox.scrolledEnd)),c>10?a.addClass(b.opts.classes.scrollBox.scrolled):a.removeClass(b.opts.classes.scrollBox.scrolled);var g=parseInt(a.data("scrollbar").css("padding-top")),h=c/f*(e-2*g)+g;a.data("scrollbar").removeClass(b.opts.classes.scrollBox.hidden),a.data("scrollbar").find("> div").css({height:(e-2*g)/f*100+"%",transform:"translate3d(0,"+h+"px,0)"}),a.data("scrollpos",c),a.data("content").css("transform","translate3d(0,-"+c+"px,0)"),clearTimeout(d[a.attr("id")]),d[a.attr("id")]=setTimeout(function(){a.data("scrollbar").addClass(b.opts.classes.scrollBox.hidden)},1500)},h=function(c){var d=c.data("scrollbar"),h=d.children("div");c.on("wheel",function(a){a.preventDefault(),a.stopPropagation();var d=c.data("scrollpos")||0,h="mouse";Math.abs(a.wheelDelta)<60&&(h="trackpad",c.addClass(b.opts.classes.scrollBox.scrollTrackpad)),g(c,d-a.wheelDelta*e[h]),f(c),c.removeClass(b.opts.classes.scrollBox.scrollTrackpad)}),h.on("mousedown",function(b){b.preventDefault(),b.stopPropagation(),a(b.currentTarget).data("startPos",b.pageY-b.currentTarget.getBoundingClientRect().top)}),c.document().on("mouseup",function(a){a.preventDefault(),a.stopPropagation(),c.removeClass(b.opts.classes.scrollBox.scrollDrag),h.removeData("startPos")}),c.document().on("mousemove",function(a){var d=h.data("startPos");if(d){c.hasClass(b.opts.classes.scrollBox.scrollDrag)||c.addClass(b.opts.classes.scrollBox.scrollDrag);var e=c.realHeight(),f=c.data("content").realHeight(),i=Math.max(0,a.pageY-c[0].getBoundingClientRect().top-d);g(c,i*f/e)}})}}}(jsu),function(a){window.SidebarEventsHelper=function(b){var c=this,d=null;this.toggleBookmarkDir=function(c){c.addClass(b.opts.classes.sidebar.dirAnimated);var d=c.next("ul"),e=function(a){d.css("height",d[0].scrollHeight+"px"),a===!1&&setTimeout(function(){d.css("height",0)},0),b.firstRun===!0?b.restoreOpenStates(d):b.helper.model.getConfig("openStates",function(d){var e=JSON.parse(d);e["node_"+c.data("infos").id]=a,b.helper.model.setConfig({openStates:JSON.stringify(e)},function(){a===!1&&f(c,e)})}),setTimeout(function(){a===!1?c.removeClass(b.opts.classes.sidebar.dirOpened):c.addClass(b.opts.classes.sidebar.dirOpened),d.css("height",""),c.removeClass(b.opts.classes.sidebar.dirAnimated),b.helper.scroll.update(b.elements.bookmarkBox,!0)},b.firstRun===!0?0:500)};c.hasClass(b.opts.classes.sidebar.dirOpened)?e(!1):0===d.length()?b.helper.model.call("bookmarks",{
id:c.data("infos").id},function(f){f.bookmarks&&f.bookmarks[0]&&f.bookmarks[0].children&&f.bookmarks[0].children.length>0&&(d=a("<ul />").insertAfter(c),b.addBookmarkDir(f.bookmarks[0].children,d),e(!0))}):e(!0)},this.init=function(){b.helper.model.getConfig("newTab",function(a){d="foreground"===a},function(a){d="foreground"===a}),e()};var e=function(){a(window).on("beforeunload",function(){b.elements.iframe.data("visibleOnce")&&b.helper.scroll.update(b.elements.bookmarkBox,!0)}).on("resize",function(){b.helper.scroll.update(b.elements.bookmarkBox,!0)}),b.elements.iframe.find("body").on("click",function(){b.helper.contextmenu.close()}),b.elements.iframeBody.on("click contextmenu","a."+b.opts.classes.sidebar.settings,function(c){c.preventDefault(),c.stopPropagation(),b.helper.contextmenu.close(),b.helper.contextmenu.create("settings",a(c.currentTarget))}),b.elements.iframeBody.on("click","div#"+b.opts.ids.sidebar.shareUserdata+" a",function(c){c.preventDefault(),b.helper.model.setConfig({shareUserdata:a(c.currentTarget).data("accept")?"y":"n",lastShareDate:0}),b.elements.iframeBody.find("div#"+b.opts.ids.sidebar.shareUserdata).addClass(b.opts.classes.sidebar.shareUserdataHidden)}),b.elements.bookmarkBox.children("ul").on("click mousedown","a",function(e){if(e.preventDefault(),"A"===e.target.tagName&&(1===e.which&&"click"===e.type||2===e.which&&"mousedown"===e.type||b.firstRun)){var f=a(e.currentTarget),g=2===e.which,h=f.data("infos"),i=!!h.children;i&&!f.hasClass(b.opts.classes.sidebar.dirAnimated)?c.toggleBookmarkDir(f):i||b.helper.model.call("openLink",{parentId:h.parentId,id:h.id,href:h.url,newTab:g,active:!g||d})}}).on("contextmenu","a",function(c){c.preventDefault(),b.helper.contextmenu.close(),b.helper.contextmenu.create("list",a(c.currentTarget))})},f=function(c,d){c.next("ul").find("a.dir").forEach(function(c){d["node_"+a(c).data("infos").id]=!1,setTimeout(function(){a(c).removeClass(b.opts.classes.sidebar.dirOpened)},500)}),b.helper.model.setConfig({openStates:JSON.stringify(d)})}}}(jsu),function(a){window.ToggleHelper=function(b){var c=null,d=null,e=null;this.init=function(){b.elements.toggle=a("<div />").attr("id",b.opts.ids.page.visual).appendTo("body"),b.helper.model.getConfig(["pxTolerance","addVisual","closeTimeout"],function(a){e=1e3*+a.closeTimeout,d=JSON.parse(a.pxTolerance),b.elements.toggle.css("width",f()+"px"),"y"===a.addVisual&&b.elements.toggle.addClass(b.opts.classes.page.addVisual)},function(a){e=1e3*+a.closeTimeout,d=JSON.parse(a.pxTolerance),b.elements.toggle.css("width",f()+"px")}),h(),g()};var f=function(){return d[b.isWindowed()?"windowed":"maximized"]},g=function(){a(window).on("resize",function(){b.elements.toggle.css("width",f()+"px")}),b.elements.iframe.find("body").on("click",function(a){a.pageX>b.elements.sidebar.realWidth()&&b.elements.iframe.hasClass(b.opts.classes.page.visible)&&(b.helper.contextmenu.close(),b.elements.sidebar.trigger("mouseenter"),b.elements.iframe.removeClass(b.opts.classes.page.visible))}),b.elements.sidebar.on("mouseleave",function(){0===a("iframe#"+b.opts.ids.page.overlay).length()&&0===b.elements.sidebar.find("."+b.opts.classes.scrollBox.scrollDrag).length()&&0===b.elements.iframeBody.find("li."+b.opts.classes.drag.dragInitial).length()&&(c=setTimeout(function(){b.helper.contextmenu.close(),b.elements.iframe.removeClass(b.opts.classes.page.visible)},e))}).on("mouseenter",function(){c&&(clearTimeout(c),c=null)}),a(document).on("visibilitychange",function(c){document.hidden&&0===a("iframe#"+b.opts.ids.page.overlay).length()&&(b.elements.toggle.removeClass(b.opts.classes.page.hover),b.elements.iframe.hasClass(b.opts.classes.page.visible)&&(b.helper.contextmenu.close(),b.elements.sidebar.trigger("mouseenter"),b.elements.iframe.removeClass(b.opts.classes.page.visible)))}).on("mousemove",function(a){a.pageX<f()?b.elements.toggle.addClass(b.opts.classes.page.hover):b.elements.toggle.removeClass(b.opts.classes.page.hover)},{passive:!0}),b.helper.model.getConfig("openAction",function(c){a(document).on(c,function(a){("mousedown"!==c||0===a.button)&&a.pageX<f()&&(a.stopPropagation(),a.preventDefault(),b.initImages(),b.elements.iframe.addClass(b.opts.classes.page.visible).data("visibleOnce",!0))})})},h=function(){a(b.opts.leftsideBackSelector).length()>0?b.elements.toggle.addClass(b.opts.classes.page.hasLeftsideBack):a(document).on(b.opts.events.lsbLoaded,function(a){a.detail.addVisual&&b.elements.toggle.addClass(b.opts.classes.page.hasLeftsideBack)})}}}(jsu),function(a){window.ext=function(b){var c=this;this.firstRun=!0,this.elements={},this.opts=b,this.run=function(){d(),g(),c.helper.sidebarEvents.init(),c.helper.dragndrop.init(),""===document.referrer&&c.helper.model.call("addViewAmount",{url:location.href})};var d=function(){c.helper={model:new window.ModelHelper(c),toggle:new window.ToggleHelper(c),scroll:new window.ScrollHelper(c),sidebarEvents:new window.SidebarEventsHelper(c),dragndrop:new window.DragDropHelper(c),checkbox:new window.CheckboxHelper(c),overlay:new window.OverlayHelper(c),contextmenu:new window.ContextmenuHelper(c)}};this.getLoaderHtml=function(){var b='<div class="loading"> <div>  <div class="circle-clipper left">   <div></div>  </div>  <div class="gap-patch">   <div></div>  </div>  <div class="circle-clipper right">   <div></div>  </div> </div></div>';return a(b)},this.isWindowed=function(){return 0!==window.screenX||0!==window.screenY||window.screen.availWidth!==window.innerWidth},this.restoreOpenStates=function(b){e++,c.helper.model.getConfig("openStates",function(d){var f=JSON.parse(d),g=0;Object.keys(f).forEach(function(c){f[c]===!0&&!function(){var d=+c.replace(/^node_/,"");b.find("> li > a.dir").forEach(function(b){+a(b).data("infos").id===d&&(g++,a(b).trigger("click",{bubbles:!0}))})}()}),e--,0===g&&0===e&&setTimeout(function(){c.firstRun=!1,c.helper.scroll.restoreScrollPos(c.elements.bookmarkBox,function(){j()})},100)})},this.addBookmarkDir=function(d,e){d.forEach(function(d,g){b.demoMode&&(d.children?d.title="Directory "+(g+1):(d.title="Bookmark "+(g+1),d.url="https://example.com/"));var h=a("<li />").appendTo(e),i=a("<a />").html(d.title+"<span class='"+c.opts.classes.drag.trigger+"' />").appendTo(h);d.children?f===!1||d.children.length>0?(d.icon=chrome.extension.getURL("img/dir.png"),i.data("infos",d).prepend("<img "+(c.firstRun?"data-":"")+"src='"+d.icon+"' />").attr("title",d.title+"\n-------------\n"+d.children.length+" "+chrome.i18n.getMessage("sidebar_dir_children")).addClass(c.opts.classes.sidebar.bookmarkDir)):h.remove():(i.attr("title",d.title+"\n-------------\n"+d.url).addClass(c.opts.classes.sidebar.bookmarkLink),c.helper.model.call("favicon",{url:d.url},function(a){b.demoMode&&(a.img=chrome.extension.getURL("img/demo/favicon-"+(Math.floor(10*Math.random())+1)+".png")),a.img&&(d.icon=a.img,i.data("infos",d).prepend("<img "+(c.firstRun?"data-":"")+"src='"+d.icon+"' />"))}))})},this.initImages=function(){c.elements.sidebar.find("img[data-src]").forEach(function(b){var c=a(b),d=c.attr("data-src");c.removeAttr("data-src"),c.attr("src",d)})},this.update=function(){c.helper.model.call("bookmarks",{id:0},function(a){a.bookmarks&&a.bookmarks[0]&&a.bookmarks[0].children&&a.bookmarks[0].children.length>0&&c.helper.model.getConfig("hideEmptyDirs",function(b){c.firstRun=!0,f="y"===b,c.elements.bookmarkBox.children("ul").text(""),c.elements.header.remove(),i(a.bookmarks[0].children),c.addBookmarkDir(a.bookmarks[0].children,c.elements.bookmarkBox.children("ul")),c.restoreOpenStates(c.elements.bookmarkBox.children("ul"))})})};var e=0,f=null,g=function(){c.elements.iframe=a('<iframe id="'+c.opts.ids.page.iframe+'" />').appendTo("body"),c.elements.iframeBody=c.elements.iframe.find("body"),c.elements.sidebar=a('<section id="'+c.opts.ids.sidebar.sidebar+'" />').appendTo(c.elements.iframeBody),c.elements.bookmarkBox=c.helper.scroll.add(c.opts.ids.sidebar.bookmarkBox,a("<ul />").appendTo(c.elements.sidebar)),a("<link />").attr({rel:"stylesheet",type:"text/css",href:c.opts.fontHref}).appendTo(c.elements.iframe.find("head")),a("<link />").attr({rel:"stylesheet",type:"text/css",href:chrome.extension.getURL("css/sidebar.css")}).appendTo(c.elements.iframe.find("head")),c.helper.model.getConfig(["entriesLocked","shareUserdata","installationDate"],function(a){"n"===a.entriesLocked&&c.elements.iframeBody.addClass(c.opts.classes.sidebar.entriesUnlocked),"undefined"==typeof a.shareUserdata&&"undefined"!=typeof a.installationDate&&(+new Date-a.installationDate)/864e5>7&&h()}),c.helper.model.call("bookmarks",{id:0},function(a){a.bookmarks&&a.bookmarks[0]&&a.bookmarks[0].children&&a.bookmarks[0].children.length>0&&(i(a.bookmarks[0].children),c.helper.model.getConfig("hideEmptyDirs",function(b){f="y"===b,c.addBookmarkDir(a.bookmarks[0].children,c.elements.bookmarkBox.children("ul")),c.restoreOpenStates(c.elements.bookmarkBox.children("ul"))},function(a){f="y"===a}))}),c.helper.toggle.init()},h=function(){var d=a("<div />").attr("id",b.ids.sidebar.shareUserdata).prependTo(c.elements.sidebar),e=a("<div />").prependTo(d);a("<h2 />").html(chrome.i18n.getMessage("share_userdata_headline")).appendTo(e),a("<p />").html(chrome.i18n.getMessage("share_userdata_desc")).appendTo(e),a("<p />").html(chrome.i18n.getMessage("share_userdata_desc2")).appendTo(e);var f=chrome.i18n.getMessage("share_userdata_notice").replace(/\[u\](.*)\[\/u\]/,"<span>$1</span>");a("<p />").addClass(b.classes.sidebar.shareUserdataNotice).html(f).appendTo(e),a("<a href='#' />").data("accept",!0).html(chrome.i18n.getMessage("share_userdata_accept")).appendTo(e),a("<a href='#' />").data("accept",!1).html(chrome.i18n.getMessage("share_userdata_decline")).appendTo(e)},i=function(b){var d=[],e=function a(b){for(var c=0;c<b.length;c++){var e=b[c];e.url?d.push(e):e.children&&a(e.children)}};e(b),c.elements.header=a("<header />").prependTo(c.elements.sidebar),a("<span />").html("<span>"+d.length+"</span> "+chrome.i18n.getMessage("header_bookmarks"+(1===d.length?"_single":""))).appendTo(c.elements.header),a("<a />").addClass(c.opts.classes.sidebar.settings).data("infos",{bookmarks:d}).appendTo(c.elements.header)},j=function(){c.helper.model.getConfig(["pxTolerance","addVisual"],function(a){c.elements.iframeBody.addClass(c.opts.classes.sidebar.extLoaded),document.dispatchEvent(new CustomEvent(c.opts.events.loaded,{detail:{pxTolerance:a.pxTolerance,addVisual:"y"===a.addVisual},bubbles:!0,cancelable:!1}))})}}}(jsu),function(){var a={ids:{page:{iframe:"moonware-bs-sidebar",overlay:"moonware-bs-overlay",visual:"moonware-bs-visual"},sidebar:{sidebar:"sidebar",bookmarkBox:"bookmarkBox",shareUserdata:"shareUserdata"},overlay:{urlList:"urlList"}},classes:{page:{addVisual:"moonware-bs-add-visual",visible:"moonware-bs-visible",hover:"moonware-bs-hover",hasLeftsideBack:"moonware-bs-has-lsb"},sidebar:{extLoaded:"loaded",active:"active",entriesUnlocked:"entriesUnlocked",dirAnimated:"animated",dirOpened:"opened",bookmarkDir:"dir",bookmarkLink:"link",settings:"settings",search:"search",shareUserdataNotice:"shareNotice",shareUserdataHidden:"hidden"},contextmenu:{wrapper:"contextmenu",top:"top",visible:"visible"},drag:{trigger:"drag",helper:"dragHelper",isDragged:"isDragged",cancel:"dragCancel",snap:"snap",dragInitial:"dragInitial"},scrollBox:{wrapper:"scrollBox",scrollbar:"scrollbar",inactive:"inactive",hidden:"hidden",scrolled:"scrolled",scrolledEnd:"scrolledEnd",scrollDrag:"scrollDrag",scrollTrackpad:"scrollTrackpad"},checkbox:{box:"checkbox",active:"active",clicked:"clicked",focus:"focus"},overlay:{modal:"modal",visible:"visible",preview:"preview",previewUrl:"previewUrl",action:"action",close:"close",hasTooltip:"tooltip",inputError:"error",progressBar:"progressBar",checkUrlProgressLabel:"progressLabel",urlCheckLoading:"urlCheckLoading",urlCheckFinished:"urlCheckFinished"}},events:{loaded:"moonware-bs-loaded",lsbLoaded:"moonware-lsb-loaded"},leftsideBackSelector:"div#moonware-lsb-main.moonware-lsb-add-visual",fontHref:"https://fonts.googleapis.com/css?family=Roboto:100,300,500,100i,300i,500i",manifest:chrome.runtime.getManifest(),demoMode:!1};new window.ext(a).run()}();